<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich" xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets">
	
	<a4j:keepAlive beanName="repConsultaSBSController" />
	
	<head>
		<script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/js/validacion.js" />
	</head>
	<body>
		<h:form id="formRepConsultaSBSStep1_A">
			<div style="text-align: center;">
				<table style="margin: auto; width: 98%;" border="0">
					<tr>
						<td style="text-align: right; width: 12%;">
							<rich:message for="idTipoAnexo" style="color: red;">
								<f:facet name="errorMarker">
									<h:graphicImage url="../imagenes/error.png" />
								</f:facet>
							</rich:message>
							<rich:spacer width="2" /><h:outputText value="* Tipo Anexo: " />
						</td>
						<td style="text-align: left; width: 15%;">
							<h:selectOneMenu id="idTipoAnexo" value="#{repConsultaSBSController.idTipoAnexo}" style=" width: 150px;" 
								valueChangeListener="#{repConsultaSBSController.buscarPeriodo}" required="true" requiredMessage="">
								<f:selectItems value="#{repConsultaSBSController.comboListaTipoAnexo}" />
								<a4j:support event="onchange" reRender="idPeriodo" />
							</h:selectOneMenu>
						</td>
						<td style="text-align: right; width: 12%;">
							<h:outputText value="Año: " />
						</td>
						<td style="text-align: left; width: 9%;">
							<h:selectOneMenu id="anio" value="#{repConsultaSBSController.anio}" style=" width: 95px;">
								<f:selectItems value="#{repConsultaSBSController.comboListaAnio}" />
							</h:selectOneMenu>
						</td>
						<td style="text-align: right; width: 12%;">
							<h:outputText value="Periodo: " />
						</td>
						<td style="text-align: left; width: 14%;">
							<h:selectOneMenu id="idPeriodo" value="#{repConsultaSBSController.idPeriodo}" style=" width: 150px;">
								<f:selectItems value="#{repConsultaSBSController.comboListaPeriodo}" />
							</h:selectOneMenu>
						</td>
						<td style="text-align: center;">
							<a4j:commandButton action="#{repConsultaSBSController.procesarConsulta}" value="Consultar" reRender="pnlLista, nroRegistros" />
						</td>
					</tr>
				</table>
			</div>
			
			<div class="datatable">
				<rich:panel id="pnlLista">
					<div class="extendedDTableContenido">
						<rich:extendedDataTable id="lista" var="itemReporteSBS" value="#{repConsultaSBSController.listaReporteSBSCabecera}" 
							width="1018px" height="342px" selectionMode="single" rows="12" keppSaved="false" reRender="true">
							<rich:column headerClass="dataTableHeader" width="30%" sortable="true" sortBy="#{itemReporteSBS.nombreArchivo}"
								sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
								<f:facet name="header">
									<h:outputText value="Nombre de Archivo" />
								</f:facet>
								<center>
									<h:outputText value="#{itemReporteSBS.nombreArchivo}" />
								</center>
							</rich:column>
							<rich:column headerClass="dataTableHeader" width="11%" sortable="true" sortBy="#{itemReporteSBS.tipoAnexo}"
								sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
								<f:facet name="header">
									<h:outputText value="T. Anexo" />
								</f:facet>
								<center>
									<h:outputText value="#{itemReporteSBS.tipoAnexo}" />
								</center>
							</rich:column>
							<rich:column headerClass="dataTableHeader" width="14%" sortable="true" sortBy="#{itemReporteSBS.nroRegistros}"
								sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
								<f:facet name="header">
									<h:outputText value="N° de Registros" />
								</f:facet>
								<center>
									<h:outputText value="#{itemReporteSBS.nroRegistros}" />
								</center>
							</rich:column>
							<rich:column headerClass="dataTableHeader" width="15%" sortable="true" sortBy="#{itemReporteSBS.fechaProceso}"
								sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
								<f:facet name="header">
									<h:outputText value="Fecha de Proceso" />
								</f:facet>
								<center>
									<h:outputText value="#{itemReporteSBS.fechaProceso}">
										<f:convertDateTime pattern="yyyy-MM-dd" />
									</h:outputText>
								</center>
							</rich:column>
							<rich:column headerClass="dataTableHeader" width="17%" sortable="true" sortBy="#{itemReporteSBS.estadoProceso}"
								sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
								<f:facet name="header">
									<h:outputText value="Estado" />
								</f:facet>
								<center>
									<h:outputText value="#{itemReporteSBS.estadoProceso}" />
								</center>
							</rich:column>
							<rich:column headerClass="dataTableHeader" width="15%">
								<f:facet name="header">
									<h:outputText value="Exportar" />
								</f:facet>
								<center>
									<h:commandLink action="#{repConsultaSBSController.descargarArchivoAdjunto}" render="true">
										<f:param value ="#{itemReporteSBS.id}" name="idSBS"/>
										<f:param value ="#{itemReporteSBS.nombreArchivo}" name="nombreArchivoSBS"/>
										<h:graphicImage url="/imagenes/export-icon.png" width="15px" height="15px" />									
									</h:commandLink>
								</center>
							</rich:column>
							<f:facet name="footer">
								<rich:datascroller id="ds" for="lista" maxPages="10" />
							</f:facet>
						</rich:extendedDataTable>
					</div>
					<div class="contadorRegistros">
						<h:outputText id="nroRegistros" value="N° de Registros encontrados: #{repConsultaSBSController.nroConsultaSBS}" />
					</div>
				</rich:panel>
			</div>
		</h:form>
		
		<h:form id="formRepConsultaSBSStep1_B">
			<div style="width: 100%; border: 0px solid white; padding: 15px 0px 5px; text-align: right;">
				<h:commandButton id="generar" action="#{repConsultaSBSController.cargarGenerarReporte}" value="> Generar Reporte" 
					render="true" reRender="panelStep1Flag, panelStep2Flag" />
			</div>
		</h:form>			
	</body>
</html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich" xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets">
	
	<a4j:keepAlive beanName="repRegistroVentasController" />
	
	<head>
		<script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/js/validacion.js" />
		<style type="text/css">
			body, html {
				font-family: Monaco, Georgia, Times, serif;
			}
			
			#panelPrincipal {
				text-align: left;
			}
			
			#imgReiniciar {
				width: 12px;
				height: 12px;
				margin: 0;
				padding: 0;
			}
			
			#formRepRegistroVentas {
				width: 97%;
				margin: 0 auto;
			}
			
			.datatable {
				padding-top: 40px;
			}
			
			.extendedDTableContenido {
				scrollbar-base-color: #3d8a3d; 
				border: 0px solid white;
				overflow-x: scroll;
				width: 1020px;
			}
			
			.botonNuevaVenta {
				float: right;
				padding-bottom: 10px;
			}
		</style>
	</head>
	<body>
		<rich:panel id="panelPrincipal">
			<f:facet name="header">
				<h:form>
					<h:outputText id="tituloCabecera" value="Reportes > Registro de Ventas" />
					<a4j:commandLink id="reiniciar"	action="#{repRegistroVentasController.inicio}" reRender="principal" style="text-decoration: none; margin-left: 10px; display: inline;">
						<img id="imgReiniciar" src="#{facesContext.externalContext.requestContextPath}/imagenes/refresh.png" />
					</a4j:commandLink>
				</h:form>
			</f:facet>
			<center>
				<fieldset id="formRepRegistroVentas">
					<h:form id="formRepRegistroVentas_A">
						<div style="text-align: center;">
							<table style="width: 98%; padding-top: 15px; margin: auto;" border="0">
								<tr>
									<td style="text-align: right; width: 18%;">
										<rich:message for="idSocioProducto" style="color: red;">
											<f:facet name="errorMarker">
												<h:graphicImage url="../imagenes/error.png" />
											</f:facet>
										</rich:message>
										<rich:spacer width="2" /><h:outputText value="* Socio: " />
									</td>
									<td style="text-align: left; width: 15%;">
										<h:selectOneMenu id="idSocioProducto" value="#{repRegistroVentasController.idSocioProducto}" style="width: 150px;" 
											required="true" requiredMessage="">
											<f:selectItems value="#{repRegistroVentasController.comboListaSocioProducto}" />
										</h:selectOneMenu>
									</td>
									<td>&nsp;</td>
									<td>&nsp;</td>
									<td>&nsp;</td>
								</tr>
								<tr>
									<td style="text-align: right; width: 18%;">
										<rich:message for="fecEmisionDesde" style="color: red;">
											<f:facet name="errorMarker">
												<h:graphicImage url="../imagenes/error.png" />
											</f:facet>
										</rich:message>
										<rich:spacer width="2" /><h:outputText value="* Fecha de Emisión (Desde): " />
									</td>
									<td style="text-align: left; width: 15%;">
										<rich:calendar id="fecEmisionDesde" enableManualInput="false" showWeeksBar="false" datePattern="yyyy-MM-dd"
											value="#{repRegistroVentasController.fecEmisionDesde}" required="true" requiredMessage="" inputStyle="width: 126px;" />
									</td>	
									<td style="text-align: right; width: 18%;">
										<rich:message for="fecEmisionHasta" style="color: red;">
											<f:facet name="errorMarker">
												<h:graphicImage url="../imagenes/error.png" />
											</f:facet>
										</rich:message>
										<rich:spacer width="2" /><h:outputText value="* Fecha de Emisión (Hasta): " />
									</td>
									<td style="text-align: left; width: 20%;">
										<rich:calendar id="fecEmisionHasta" enableManualInput="false" showWeeksBar="false" datePattern="yyyy-MM-dd"
											value="#{repRegistroVentasController.fecEmisionHasta}" required="true" requiredMessage="" inputStyle="width: 126px;" />
									</td>
									<td style="text-align: left;">
										<a4j:commandButton action="#{repRegistroVentasController.procesarConsulta}" value="Consultar" style="width: 85px;" 
											render="true" reRender="pnlLista, exportar" />
									</td>
								</tr>
							</table>
						</div>
					</h:form>
					
					<h:form id="formRepRegistroVentas_B">
						<div class="datatable">
							<rich:panel id="pnlLista" style="width: 98%;">
								<div class="botonNuevaVenta">
									<a4j:commandButton action="#{repRegistroVentasController.cargarNuevaVenta}" value="Nueva Venta" style="width: 85px;" 
										oncomplete="#{null == facesContext.maximumSeverity ? 'Richfaces.showModalPanel(\'panelNuevoRegistroVenta\')' : ';'}"
										reRender="panelNuevoRegistroVenta" />
								</div>
								<div class="extendedDTableContenido">
									<rich:extendedDataTable id="lista" var="itemRegistroVta" value="#{repRegistroVentasController.listaRegistroVentas}" 
										width="1300px" height="285px" selectionMode="single" rows="10" keppSaved="false" reRender="true">
										<rich:column headerClass="dataTableHeader" width="9.5%" sortable="true" sortBy="#{itemRegistroVta.fechaEmision}"
											sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
											<f:facet name="header">
												<h:outputText value="Fec. Emisión" />
											</f:facet>
											<center>
												<h:outputText value="#{itemRegistroVta.fechaEmision}">
													<f:convertDateTime pattern="yyyy-MM-dd" />
												</h:outputText>
											</center>
										</rich:column>
										<rich:column headerClass="dataTableHeader" width="6%" sortable="true" sortBy="#{itemRegistroVta.tipoComprobante}"
											sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
											<f:facet name="header">
												<h:outputText value="Tipo" />
											</f:facet>
											<center>
												<h:outputText value="#{itemRegistroVta.tipoRegistroVenta}" />
											</center>
										</rich:column>
										<rich:column headerClass="dataTableHeader" width="12%" sortable="true" sortBy="#{itemRegistroVta.nroSerie} - #{itemRegistroVta.correlativoSerie}"
											sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
											<f:facet name="header">
												<h:outputText value="Serie - Correlativo" />
											</f:facet>
											<center>
												<h:outputText value="#{itemRegistroVta.nroSerie} - #{itemRegistroVta.correlativoSerie}" />
											</center>
										</rich:column>
										<rich:column headerClass="dataTableHeader" width="10%" sortable="true" sortBy="#{itemRegistroVta.nroDocCliente}"
											sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
											<f:facet name="header">
												<h:outputText value="N° Documento" />
											</f:facet>
											<center>
												<h:outputText value="#{itemRegistroVta.nroDocCliente}" />
											</center>
										</rich:column>
										<rich:column headerClass="dataTableHeader" width="20%" sortable="true" sortBy="#{itemRegistroVta.nombreRazonSocial}"
											sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
											<f:facet name="header">
												<h:outputText value="Nombre / Razón Social" />
											</f:facet>
											<center>
												<h:outputText value="#{itemRegistroVta.nombreRazonSocial}" />
											</center>
										</rich:column>
										<rich:column headerClass="dataTableHeader" width="8%" sortable="true" sortBy="#{itemRegistroVta.baseImponible}"
											sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
											<f:facet name="header">
												<h:outputText value="Base" />
											</f:facet>
											<center>
												<h:outputText value="#{itemRegistroVta.baseImponible}" >
													<f:convertNumber pattern="#,##0.00" locale="en_US" />
												</h:outputText>
											</center>
										</rich:column>
										<rich:column headerClass="dataTableHeader" width="8%" sortable="true" sortBy="#{itemRegistroVta.impuestoIGV}"
											sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
											<f:facet name="header">
												<h:outputText value="IGV" />
											</f:facet>
											<center>
												<h:outputText value="#{itemRegistroVta.impuestoIGV}" >
													<f:convertNumber pattern="#,##0.00" locale="en_US" />
												</h:outputText>
											</center>
										</rich:column>
										<rich:column headerClass="dataTableHeader" width="8%" sortable="true" sortBy="#{itemRegistroVta.importeTotal}"
											sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
											<f:facet name="header">
												<h:outputText value="Importe" />
											</f:facet>
											<center>
												<h:outputText value="#{itemRegistroVta.importeTotal}" >
													<f:convertNumber pattern="#,##0.00" locale="en_US" />
												</h:outputText>
											</center>
										</rich:column>
										<rich:column headerClass="dataTableHeader" width="10%" sortable="true" sortBy="#{itemRegistroVta.nroPoliza}"
											sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
											<f:facet name="header">
												<h:outputText value="N° de Póliza" />
											</f:facet>
											<center>
												<h:outputText value="#{itemRegistroVta.nroPoliza}" />
											</center>
										</rich:column>
										<rich:column headerClass="dataTableHeader" width="10%" sortable="true" sortBy="#{itemRegistroVta.observacion}"
											sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
											<f:facet name="header">
												<h:outputText value="Observación" />
											</f:facet>
											<center>
												<h:outputText value="#{itemRegistroVta.observacion}" />
											</center>
										</rich:column>
										<f:facet name="footer">
											<rich:datascroller id="dsLista" rows="10" for="lista" />
										</f:facet>
									</rich:extendedDataTable>
								</div>
							</rich:panel>	
							<div style="width: 100%; padding-top: 10px;	text-align: center;">
								<h:commandButton id="exportar" action="#{repRegistroVentasController.exportar}" value="Exportar" style="width: 85px;" 
									disabled="#{repRegistroVentasController.disabledBtnExportar}" />
							</div>
						</div>
					</h:form>
				</fieldset>
			</center>
		</rich:panel>
	</body>
	
	<rich:modalPanel id="panelNuevoRegistroVenta" autosized="true">
		<f:facet name="controls">
			<h:panelGroup>
				<h:graphicImage id="hidelink" value="/imagenes/close.gif" styleClass="hidelink" />
				<rich:componentControl for="panelNuevoRegistroVenta" attachTo="hidelink" operation="hide" event="onclick" />
			</h:panelGroup>
		</f:facet>
		<h:form>
			<a4j:region>
				<a4j:include viewId="/paginas/reportes/repNuevoRegistroVentaPopup.xhtml" />
			</a4j:region>
		</h:form>
	</rich:modalPanel>
</html>
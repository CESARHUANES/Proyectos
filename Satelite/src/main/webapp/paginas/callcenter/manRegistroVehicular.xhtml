<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich" xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets">
<a4j:keepAlive beanName="registroVehicularController" />
<head>
<script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/js/validacion.js" />
<script type="text/javascript">
function email_validate(email)
{
	var regMail = /^([_a-zA-Z0-9-]+)(\.[_a-zA-Z0-9-]+)*@([a-zA-Z0-9-]+\.)+([a-zA-Z]{2,3})$/;
	var accion = true;
	if(regMail.test(email) == false)
	{
	document.getElementById("status").innerHTML = "email no válido.";
	accion=false
	}
	else
	{	document.getElementById("status").innerHTML = "";
	}
	
	return accion;
 }

function valAlfaNumericos(evt){
	var respuesta = true;
	evt = evt || window.event;
	var charCode = evt.which || evt.keyCode;
	var charStr = String.fromCharCode(charCode);
	if (/[a-z0-9]/i.test(charStr) || evt.keyCode==8) {
		respuesta = true;   
	}else{
		respuesta = false;
	}
	return respuesta;
}
	</script>
</head>

<body>
	<rich:panel id="consultar" height="100%">
		<f:facet name="header">
			<h:outputText value="Call Center > Registro Vehicular" />
		</f:facet>
		<fieldset id="formContratante">
			<legend>Datos del propietario</legend>
			<a4j:region ajaxSingle="true">
				<table style="margin: 0 auto; width: 700px;">

					<tr>
						<td width="21%" align="right"><rich:message for="numDocumento" style="color: red;">
								<f:facet name="errorMarker">
									<h:graphicImage url="../imagenes/error.png" />
								</f:facet>
							</rich:message> <rich:spacer width="5"></rich:spacer> <h:outputText value="DNI" /></td>

						<td style="width: 20%; text-align: left;"><h:inputText id="numDocumento" value="#{registroVehicularController.propietario.rutPropietario}"
								minLength="8" maxlength="8" class="celda" onkeypress="return valNumeros(event);" required="true" requiredMessage="Obligatorio"
								disabled="#{registroVehicularController.disabledPropietario}" /></td>
						<td width="3%" align="left"><a4j:commandButton action="#{registroVehicularController.buscarPropietario}" onclick="this.disabled=true"
								oncomplete="this.disabled=false" display="" reRender="nombres, apPaterno, apMaterno, email, fechaNac,aceptar" value="Buscar"
								disabled="#{registroVehicularController.disabledPropietario}"></a4j:commandButton></td>

						<td width="22%" align="right"></td>
						<td style="width: 20%; text-align: left;"></td>
					</tr>
				</table>
			</a4j:region>
			<table style="margin: 0 auto; width: 700px;">
				<tr>
					<td width="20%" align="right"><rich:message for="nombres" style="color: red;">
							<f:facet name="errorMarker">
								<h:graphicImage url="../imagenes/error.png" />
							</f:facet>
						</rich:message> <rich:spacer width="5"></rich:spacer> <h:outputText value="Nombres" /></td>

					<td style="width: 20%; text-align: left;"><h:inputText id="nombres" value="#{registroVehicularController.propietario.nombres}"
							maxlength="50" class="celda" onkeyup="value=value.toUpperCase()" required="true" requiredMessage="Obligatorio"
							disabled="#{registroVehicularController.disabledPropietario}" /></td>
					<td width="3%" align="left"></td>

					<td width="22%" align="right"><rich:message for="apPaterno" style="color: red;">
							<f:facet name="errorMarker">
								<h:graphicImage url="../imagenes/error.png" />
							</f:facet>
						</rich:message> <rich:spacer width="5"></rich:spacer> <h:outputText value="Apellido Paterno" /></td>
					<td style="width: 20%; text-align: left;"><h:inputText id="apPaterno" readonly="readonly"
							value="#{registroVehicularController.propietario.paterno}" maxlength="50" onkeyup="value=value.toUpperCase()" class="celda" required="true"
							requiredMessage="Obligatorio" disabled="#{registroVehicularController.disabledPropietario}" /></td>
				</tr>
				<tr>
					<td width="20%" align="right"><rich:message for="apMaterno" style="color: red;">
							<f:facet name="errorMarker">
								<h:graphicImage url="../imagenes/error.png" />
							</f:facet>
						</rich:message> <rich:spacer width="5"></rich:spacer> <h:outputText value="Apellido Materno" /></td>
					<td style="width: 20%; text-align: left;"><h:inputText id="apMaterno" value="#{registroVehicularController.propietario.materno}"
							maxlength="50" class="celda" onkeyup="value=value.toUpperCase()" required="true" requiredMessage="Obligatorio"
							disabled="#{registroVehicularController.disabledPropietario}" /></td>
					<td width="3%" align="left"></td>
					<td width="22%" align="right"><rich:spacer width="5"></rich:spacer> <h:outputText value="Email" /></td>
					<td style="width: 20%; text-align: left;"><h:inputText id="email" name="email" value="#{registroVehicularController.propietario.email}"
							maxlength="50" class="celda" onkeyup="email_validate(this.value);" disabled="#{registroVehicularController.disabledPropietario}" /> <span
						id="status" style="color: red;"></span></td>
				</tr>

				<tr>
					<td width="20%" align="right"><rich:message for="fechaNac" style="color: red;">
							<f:facet name="errorMarker">
								<h:graphicImage url="../imagenes/error.png" />
							</f:facet>
						</rich:message> <rich:spacer width="5"></rich:spacer> <h:outputText value="Fecha de Nacimiento(dd/MM/yyyy)" /></td>
					<td style="width: 20%; text-align: left;"><rich:calendar id="fechaNac" enableManualInput="true" datePattern="dd/MM/yyyy"
							value="#{registroVehicularController.propietario.fechaNacimiento}" showWeeksBar="false" required="false" requiredMessage="Obligatorio"
							converterMessage="La fecha ingresada no es válida, debe tener el formato 'dd/MM/yyyy'"
							disabled="#{registroVehicularController.disabledPropietario}">
						</rich:calendar></td>
					<td width="3%" align="left"></td>
					<td width="22%" align="right"></td>
					<td style="width: 20%; text-align: left;"></td>
				</tr>
				<!-- <tr>
							<td colspan="2" height="10px"></td>
							
						</tr> -->

			</table>

		</fieldset>
		<fieldset id="formVehiculo">
			<legend>Datos del Vehiculo</legend>
			<!--  <a4j:region ajaxSingle="true">-->

			<table>
				<tr>
					<td width="20%" align="right"><rich:message for="placa" style="color: red;">
							<f:facet name="errorMarker">
								<h:graphicImage url="../imagenes/error.png" />
							</f:facet>
						</rich:message> <rich:spacer width="5"></rich:spacer> <h:outputText value="Placa" /></td>
					<td style="width: 20%; text-align: left;"><h:inputText id="placa" readonly="true" value="#{registroVehicularController.vehiculoPe.placa}"
							maxlength="6" minlength="6" class="celda" onkeyup="value=value.toUpperCase()" onkeydown="return valNumerosLetras(event)" onblur="limpia()"
							required="true" requiredMessage="Obligatorio" style="background:#ddd;" /></td>
					<td width="3%" align="left"></td>
					<td style="width: 22%; text-align: right;"></td>
					<td width="20%" align="left"></td>
				</tr>
				<tr>
					<td width="20%" align="right"><rich:message for="marca" style="color: red;">
							<f:facet name="errorMarker">
								<h:graphicImage url="../imagenes/error.png" />
							</f:facet>
						</rich:message> <rich:spacer width="5"></rich:spacer> <h:outputText value="Marca" /></td>
					<td style="width: 20%; text-align: left;"><h:selectOneMenu id="marca" value="#{registroVehicularController.vehiculoPe.marcaVehiculo}"
							style=" width : 153px;" valueChangeListener="#{registroVehicularController.buscarModelo}" required="true" requiredMessage="Obligatorio">
							<f:selectItems value="#{registroVehicularController.marcaItems}" />
							<a4j:support event="onchange" ajaxOnly="true" reRender="cModelo" />
						</h:selectOneMenu></td>
					<td width="3%" align="left"></td>
					<td width="22%" align="right"><rich:message for="cModelo" style="color: red;">
							<f:facet name="errorMarker">
								<h:graphicImage url="../imagenes/error.png" />
							</f:facet>
						</rich:message> <rich:spacer width="5"></rich:spacer> <h:outputText value="Modelo" /></td>
					<td style="width: 20%; text-align: left;"><h:selectOneMenu id="cModelo" value="#{registroVehicularController.vehiculoPe.modeloVehiculo}"
							style=" width : 153px;" required="true" requiredMessage="Obligatorio">
							<f:selectItems value="#{registroVehicularController.modeloItems}" />
							<a4j:support event="onchange" ajaxOnly="true" />
						</h:selectOneMenu></td>
				</tr>
				<tr>
					<td width="20%" align="right"><h:outputText value="Nueva Marca" /></td>
					<td style="width: 20%; text-align: left;"><h:inputText id="marca_opc" value="" maxlength="6" class="celda"
							onkeyup="value=value.toUpperCase()" disabled="true" style="color:#ddd; background:#ddd;" /></td>
					<td width="3%" align="left"></td>
					<td width="22%" align="right"><h:outputText value="Nuevo Modelo" /></td>
					<td style="width: 20%; text-align: left;"><h:inputText id="modelo_opc" value="" maxlength="6" class="celda"
							onkeyup="value=value.toUpperCase()" disabled="true" style="color:#ddd; background:#ddd;" /></td>
				</tr>
				<tr>
					<td width="20%" align="right"><rich:message for="serie" style="color: red;">
							<f:facet name="errorMarker">
								<h:graphicImage url="../imagenes/error.png" />
							</f:facet>
						</rich:message> <rich:spacer width="5"></rich:spacer> <h:outputText value="Serie" /></td>
					<td style="width: 20%; text-align: left;"><h:inputText id="serie" value="#{registroVehicularController.vehiculoPe.numeroSerie}"
							maxlength="20" class="celda" onkeypress="return valAlfaNumericos(event);" onkeyup="value=value.toUpperCase();" requiredMessage="Obligatorio" /></td>
					<td width="3%" align="left"></td>
					<td width="22%" align="right"><rich:message for="anioFabricacion" style="color: red;">
							<f:facet name="errorMarker">
								<h:graphicImage url="../imagenes/error.png" />
							</f:facet>
						</rich:message> <rich:spacer width="5"></rich:spacer> <h:outputText value="Año Fabricación" /></td>
					<td style="width: 20%; text-align: left;"><h:selectOneMenu id="anioFabricacion"
							value="#{registroVehicularController.vehiculoPe.anioVehiculo}" style=" width : 153px;" required="true" requiredMessage="Obligatorio">
							<f:selectItems value="#{registroVehicularController.anioItems}" />
						</h:selectOneMenu></td>
				</tr>
				<tr>
					<td width="20%" align="right"><rich:message for="uso" style="color: red;">
							<f:facet name="errorMarker">
								<h:graphicImage url="../imagenes/error.png" />
							</f:facet>
						</rich:message> <rich:spacer width="5"></rich:spacer> <h:outputText value="Uso" /></td>
					<td style="width: 20%; text-align: left;"><h:selectOneMenu id="uso" value="#{registroVehicularController.vehiculoPe.usoVehiculo}"
							style=" width : 153px;" required="true" requiredMessage="Obligatorio">
							<f:selectItems value="#{registroVehicularController.usoVehiculoItems}" />
						</h:selectOneMenu></td>
					<td width="3%" align="left"></td>
					<td width="22%" align="right"><rich:message for="categoria" style="color: red;">
							<f:facet name="errorMarker">
								<h:graphicImage url="../imagenes/error.png" />
							</f:facet>
						</rich:message> <rich:spacer width="5"></rich:spacer> <h:outputText value="Categoría" /></td>
					<td style="width: 20%; text-align: left;"><h:selectOneMenu id="categoria"
							value="#{registroVehicularController.vehiculoPe.categoriaClaseVehiculo}" style=" width : 153px;" required="true" requiredMessage="Obligatorio">
							<f:selectItems value="#{registroVehicularController.categoriaItems}" />
						</h:selectOneMenu></td>
				</tr>
				<tr>
					<td width="20%" align="right"><rich:message for="numeroAsiento" style="color: red;">
							<f:facet name="errorMarker">
								<h:graphicImage url="../imagenes/error.png" />
							</f:facet>
						</rich:message> <rich:spacer width="5"></rich:spacer> <h:outputText value="Nro. Asientos" /></td>
					<td style="width: 20%; text-align: left;"><h:selectOneMenu id="numeroAsiento"
							value="#{registroVehicularController.vehiculoPe.numeroAsiento}" style=" width : 153px;" required="true" requiredMessage="Obligatorio">
							<f:selectItems value="#{registroVehicularController.asientoItems}" />
						</h:selectOneMenu></td>
					<td width="3%" align="left"></td>
					<td width="22%" align="right"><rich:message for="departamento" style="color: red;">
							<f:facet name="errorMarker">
								<h:graphicImage url="../imagenes/error.png" />
							</f:facet>
						</rich:message> <rich:spacer width="5"></rich:spacer> <h:outputText value="Departamento" /></td>
					<td style="width: 20%; text-align: left;"><h:selectOneMenu id="departamento"
							value="#{registroVehicularController.direccionPropietarioVehiculo.direccion}" style=" width : 153px;" required="true"
							requiredMessage="Obligatorio">
							<f:selectItems value="#{registroVehicularController.departamentoItems}" />
						</h:selectOneMenu></td>
				</tr>
			</table>
		</fieldset>
		<center>
			<a4j:commandButton id="aceptar" action="#{registroVehicularController.guardarVehiculo}" onclick="this.disabled=true;" value="Aceptar"
				oncomplete="#{facesContext.maximumSeverity == null ? 'Richfaces.showModalPanel(\'panel\');this.disabled=false;' : 'this.disabled=false;'}"
				disabled="#{!registroVehicularController.flagPropietario}"
				reRender="lista, editar, registrar, numDocumento, nombres, apPaterno, apMaterno, email, fechaNac" />
			<a4j:commandButton onclick="Richfaces.hideModalPanel('panelMantenimiento');" action="#{registroVehicularController.limpiarPropietario}"
				value="Cancelar" immediate="true" reRender="editar, registrar,numDocumento, nombres, apPaterno, apMaterno, email, fechaNac" />
		</center>
	</rich:panel>
	<rich:modalPanel id="panel" width="250" height="130">
		<f:facet name="header">Mensaje</f:facet>
		<h:panelGroup>
			<center>
				<h5>Datos guardados con éxito!.</h5>
				<a4j:commandButton value="Aceptar" reRender="lista"
					onclick="#{rich:component('panel')}.hide(); #{rich:component('panelMantenimiento')}.hide(); return false"
					oncomplete="#{facesContext.maximumSeverity == null ? 'Richfaces.hideModalPanel(\'panelMantenimiento\')' : ';'}" />
				<rich:componentControl for="panelMantenimiento" attachTo="hidelink" operation="hide" event="onclick"></rich:componentControl>
			</center>
		</h:panelGroup>
	</rich:modalPanel>
</body>
</html>

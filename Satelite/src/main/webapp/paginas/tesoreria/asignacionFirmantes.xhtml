<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich" xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets">

<a4j:keepAlive beanName="asignacionController" />

<head>
<style type="text/css">
body {
	font-size: 11px;
	color: #000;
	font-family: Arial, Verdana, sans-serif;
}

.celda {
	width: 138px;
	display: block;
}

.label {
	width: 100px;
	display: block;
}

.extdt-menu-div-out, .extdt-menu-div-on {
	display: none !important;
}
</style>



<meta http-equiv="cache-control" content="max-age=0" />
<meta http-equiv="cache-control" content="no-cache" />
<meta http-equiv="expires" content="0" />
<meta http-equiv="pragma" content="no-cache" />
</head>
<body>

	<rich:panel id="pnlAsignacion">
		<f:facet name="header">
			<h:form id="frmActualizar">
				<h:outputText value="Tesorería > Asignación de Firmantes">
				</h:outputText>

				<a4j:commandLink action="#{asignacionController.inicio}" reRender="principal" style="text-decoration:none; margin-left:10px">
					<img src="#{facesContext.externalContext.requestContextPath}/imagenes/refresh.png" width="15" height="15" style="margin: 0; padding: 0" />
				</a4j:commandLink>

			</h:form>

		</f:facet>
		<h:form id="frmBuscar">
			<fieldset style="margin-bottom: 20px; padding: 20px;">
				<legend>Filtros de búsqueda</legend>
				<h:panelGrid columns="5" cellspacing="5">

					<h:outputLabel value="Banco:" styleClass="label"></h:outputLabel>

					<h:selectOneMenu id="selectBanco" value="#{asignacionController.banco}" required="true" requiredMessage="Obligatorio" style="width:142px">
						<f:selectItems value="#{asignacionController.bancos}" />
					</h:selectOneMenu>

					<rich:message for="selectBanco" style="color: red;">
						<f:facet name="errorMarker">
							<h:graphicImage url="../imagenes/error.png" />
						</f:facet>
					</rich:message>

					<h:outputLabel value="Fecha desde:" styleClass="label"></h:outputLabel>
					<rich:calendar id="fechaDesde" enableManualInput="false" datePattern="dd/MM/yyyy" styleClass="celda" value="#{asignacionController.fechaDesde}"
						showWeeksBar="false" required="false" />

					<h:outputLabel value="Número de cheque:" styleClass="label">
					</h:outputLabel>
					<h:inputText value="#{asignacionController.numeroCheque}" styleClass="celda"></h:inputText>
					<h:outputLabel></h:outputLabel>
					<h:outputLabel value="Fecha hasta:" styleClass="label"></h:outputLabel>
					<rich:calendar id="fechaHasta" enableManualInput="false" datePattern="dd/MM/yyyy" styleClass="celda" value="#{asignacionController.fechaHasta}"
						showWeeksBar="false" required="false" />
				</h:panelGrid>
				<h:panelGrid columns="2" cellspacing="5" style="float:right">
					<a4j:commandButton id="btnBuscar" action="#{asignacionController.buscar}" value="Buscar" reRender="tblCheques"></a4j:commandButton>
					<a4j:commandButton id="btnLimpiar" action="#{asignacionController.limpiar}" value="Limpiar" reRender="tblCheques,frmBuscar"></a4j:commandButton>
				</h:panelGrid>
			</fieldset>
		</h:form>
		<h:form id="frmAsignar">
			<fieldset style="padding: 20px;">
				<legend>Asignación de firmantes</legend>
				<h:panelGrid>

					<h:panelGrid columns="3">
						<h:outputText value="Firmantes:" styleClass="label"></h:outputText>
						<h:selectOneMenu id="selectPar" value="#{asignacionController.par}" required="true" requiredMessage="Obligatorio" style="width:142px">
							<f:selectItems value="#{asignacionController.pares}" />
						</h:selectOneMenu>

						<rich:message for="selectPar" style="color: red;">
							<f:facet name="errorMarker">
								<h:graphicImage url="../imagenes/error.png" />
							</f:facet>
						</rich:message>
					</h:panelGrid>
					<rich:extendedDataTable id="tblCheques" var="cheque" value="#{asignacionController.cheques}" width="1050px" height="260px" rows="200"
						selectedClass="dataTableSelectedRow" sortMode="single" selectionMode="none" reRender="true">

						<rich:column id="colNumero" headerClass="dataTableHeader" width="200" sortable="true" sortBy="#{cheque.numero}">
							<f:facet name="header">
								<h:outputText value="Número de cheque" />
							</f:facet>
							<center>
								<h:outputText value="#{cheque.numero}" />
							</center>
						</rich:column>
						<rich:column id="colBanco" headerClass="dataTableHeader" width="100" sortable="true" sortBy="#{cheque.banco}">
							<f:facet name="header">
								<h:outputText value="Banco" />
							</f:facet>
							<center>
								<h:outputText value="#{cheque.banco}" />
							</center>
						</rich:column>
						<rich:column id="colBeneficiario" headerClass="dataTableHeader" width="350" sortable="true" sortBy="#{cheque.nombreBeneficiario}">
							<f:facet name="header">
								<h:outputText value="Nombre beneficiario" />
							</f:facet>
							<center>
								<h:outputText value="#{cheque.nombreBeneficiario}" />
							</center>
						</rich:column>
						<rich:column id="colMoneda" headerClass="dataTableHeader" width="100" sortable="true" sortBy="#{cheque.tipoMoneda}">
							<f:facet name="header">
								<h:outputText value="Moneda" />
							</f:facet>
							<center>
								<h:outputText value="#{cheque.tipoMoneda}" />
							</center>
						</rich:column>
						<rich:column id="colImporte" headerClass="dataTableHeader" width="100" sortable="true" sortBy="#{cheque.importe}">
							<f:facet name="header">
								<h:outputText value="Importe" />
							</f:facet>
							<center>
								<h:outputText value="#{cheque.importe}" style="float:right">
									<f:convertNumber locale="en_US" />
								</h:outputText>
							</center>
						</rich:column>

						<rich:column id="colFecha" headerClass="dataTableHeader" width="100" sortable="true" sortBy="#{cheque.fechaRegistro}">
							<f:facet name="header">
								<h:outputText value="Fecha" />
							</f:facet>
							<center>
								<h:outputText value="#{cheque.fechaRegistro}">
									<f:convertDateTime pattern="yyyy-MM-dd" />
								</h:outputText>
							</center>
						</rich:column>

						<!-- 						<rich:column id="colSel" headerClass="dataTableHeader" width="100" sortable="true" sortBy="#{cheque.seleccionado}">
							<f:facet name="header">
								<h:outputText value="Seleccionar" />
							</f:facet>
							<center>

								<h:selectBooleanCheckbox value="#{cheque.seleccionado}">
								</h:selectBooleanCheckbox>
							</center>
						</rich:column> -->

						<rich:column id="colSel" headerClass="dataTableHeader" width="100" sortable="true">
							<f:facet name="header">
								<h:panelGroup style="width:100px;" layout="block">

									<script type="text/javascript">
										//<![CDATA[
										function checkAllCheckboxesInTable(inputId, state) {
											var commonIdPart = inputId.substr(0, inputId.lastIndexOf(':'));
											var tableId = commonIdPart + ':tu'
											var tableElement = document.getElementById(tableId);
											var inputs = tableElement.getElementsByTagName('input');
											for (var i = 0; i <= inputs.length; i++) {
												var input = inputs[i];
												if (input.getAttribute('type') == 'checkbox' && state) {
													input.setAttribute('checked', state);
												} else {
													input.removeAttribute('checked');
												}
											}
										}
										//]]>
									</script>
									<h:selectBooleanCheckbox id="checkAll" title="#seleccionar" onclick="checkAllCheckboxesInTable( this.id, this.checked );">
										<a4j:support event="onchange" reRender="IdList" />
									</h:selectBooleanCheckbox>
									<h:outputText value="Seleccionar" />
								</h:panelGroup>
							</f:facet>
							<h:selectBooleanCheckbox id="checkEntry" value="#{cheque.seleccionado}" disabled="false" />
						</rich:column>

						<f:facet name="footer">
							<rich:datascroller id="ds" for="tblCheques" maxPages="10"></rich:datascroller>
						</f:facet>
					</rich:extendedDataTable>

					<h:panelGrid columns="3" id="pnlOpciones" style="padding-top:20px">

						<a4j:commandButton id="btnPreVisualizar" value="Pre-visualizar" action="#{asignacionController.prepararVisualizacion}" reRender="popup"
							oncomplete="if(#{asignacionController.mostrar})#{rich:component('popup')}.show(); return false;" />

						<a4j:commandButton id="btnAsignar" value="Asignar" action="#{asignacionController.asignar}" reRender="tblCheques" />

					</h:panelGrid>
				</h:panelGrid>
			</fieldset>
		</h:form>
	</rich:panel>


	<rich:modalPanel id="popup" width="850" height="550">
		<f:facet name="header">
			<h:panelGroup>
				<h:outputText value="Previsualización de cheques"></h:outputText>
			</h:panelGroup>
		</f:facet>
		<f:facet name="controls">
			<h:panelGroup>
				<h:graphicImage value="/imagenes/close.gif" styleClass="hidelink" id="hidelink" />
				<rich:componentControl for="popup" attachTo="hidelink" operation="hide" event="onclick" />
			</h:panelGroup>
		</f:facet>
		<a4j:outputPanel id="pnlPDF">
			<h:form>

				<a4j:mediaOutput id="docPdf" createContent="#{asignacionController.pintar}" element="object" cacheable="false" value="" session="true"
					mimeType="application/pdf" type="application/pdf" style="width:825px; height:460px;" />
				<br />
				<center>
					<a4j:commandButton value="Cancelar">
						<rich:componentControl for="popup" operation="hide" event="onclick" />
					</a4j:commandButton>
				</center>
			</h:form>
		</a4j:outputPanel>
	</rich:modalPanel>



</body>
</html>
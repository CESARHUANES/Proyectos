<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich" xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets">

<a4j:keepAlive beanName="genReversaComprobantesController" />
<head>
<script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/js/validacion.js" />

<style type="text/css">
body, html {
	font-family: Monaco, Georgia, Times, serif;
	width: 100%;
	height: 100%;
}

#panelPrincipal {
	text-align: left;
}

#formGeneracionReversa {
	width: 1000px;
	margin: 0 auto;
	color:
}

.datatable {
	padding-top: 10px;
}

.celda {
	width: 130px;
	color: #000;
}

.outputTitle {
	font-weight: bold;
	padding: 0px 10px !important;
}
</style>
</head>
<body>
	<rich:panel id="panelPrincipal" height="100%" reRender="lista">
		<f:facet name="header">
			<h:form id="formRefresh">
				<h:outputText value="Tesorería > Generación Reversa" />
				<a4j:commandLink action="#{genReversaComprobantesController.inicio}" reRender="principal" style="text-decoration:none; margin-left:10px">
					<img src="#{facesContext.externalContext.requestContextPath}/imagenes/refresh.png" width="15" height="15" style="margin: 0; padding: 0" />
				</a4j:commandLink>
			</h:form>
		</f:facet>
		<center>
			<fieldset id="formGeneracionReversa">
				<legend />
				<h:form>
					<div style="text-align: center;">
						<table style="margin: auto; width: 100%" border="0">
							<tr>
								<td colspan="6" style="text-align: left;"><h:outputText value="Compañia" styleClass="outputTitle" /></td>
							</tr>
							<tr>
								<td style="text-align: right; width: 12%;"><rich:message for="idUnidadNegocio" style="color: red;">
										<f:facet name="errorMarker">
											<h:graphicImage url="../imagenes/error.png" />
										</f:facet>
									</rich:message> <rich:spacer width="5" /> <h:outputText value="* Razón Social: " /></td>
								<td style="text-align: left; width: 20%;"><h:selectOneMenu id="idUnidadNegocio"
										value="#{genReversaComprobantesController.idUnidadNegocio}" style=" width: 150px;" required="true" requiredMessage="">
										<f:selectItems value="#{genReversaComprobantesController.comboListaUnidadNegocio}" />
									</h:selectOneMenu></td>
								<td>
									&nsp;
								</td>
								<td>
									&nsp;
								</td>
								<td>
									&nsp;
								</td>
								<td>
									&nsp;
								</td>
							</tr>
							<tr>
								<td colspan="6">
									<div style="width: 100%; border-top: 1px solid #C0C0C0; margin: 5px 0;"></div>
								</td>
							</tr>
							<tr>
								<td style="text-align: right; width: 12%;"><rich:message for="fecEmision" style="color: red;">
										<f:facet name="errorMarker">
											<h:graphicImage url="../imagenes/error.png" />
										</f:facet>
									</rich:message> <rich:spacer width="5" /> <h:outputText value="Fecha Emisión: " /></td>
								<td style="text-align: left; width: 20%;"><rich:calendar id="fecEmision" enableManualInput="false" showWeeksBar="false"
										datePattern="yyyy-MM-dd" value="#{genReversaComprobantesController.fecEmision}" required="true" requiredMessage=""
										inputStyle="width: 125px;" /></td>
								<td style="text-align: right; width: 10%;"><h:outputText value="Nro. Certificado: " /></td>
								<td style="text-align: left; width: 20%;"><h:inputText id="nroCertificado" value="#{genReversaComprobantesController.nroCertificado}"
										style="width: 145px;" maxlength="13" onkeyup="value=value.toUpperCase()" /></td>
								<td>
									&nsp;
								</td>
								<td>
									&nsp;
								</td>
							</tr>
							<tr>
								<td style="text-align: right; width: 10%;"><h:outputText value="RUC: " /></td>
								<td style="text-align: left;"><h:inputText id="rucProveedor" value="#{genReversaComprobantesController.rucProveedor}"
										style="width: 145px;" maxlength="11" onkeypress="return valNumeros(event)" /></td>
								<td>
									&nsp;
								</td>
								<td>
									&nsp;
								</td>
								<td>
									&nsp;
								</td>
								<td style="text-align: left;"><a4j:commandButton id="buscarComprobantes" style="margin:0 5px;" value="Buscar"
										action="#{genReversaComprobantesController.buscar}" reRender="pnlLista, generarTXT" /></td>
							</tr>
						</table>
					</div>
					<br />
					<rich:panel id="pnlLista">
						<div style="scrollbar-base-color: #3D8A3D; width: 1000px; border: 0px solid white; overflow-x: scroll;">
							<rich:extendedDataTable id="lista" var="itemComprobante" value="#{genReversaComprobantesController.listaCertRetencionReversa}" width="998px"
								height="280px" selectionMode="single" reRender="true" keppSaved="false">
								<rich:column id="colEnFechaEmision" headerClass="dataTableHeader" width="14%" sortable="true" sortBy="#{itemComprobante.enFechaEmision}"
									sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
									<f:facet name="header">
										<h:outputText value="Fecha Emisión" />
									</f:facet>
									<center>
										<h:outputText value="#{itemComprobante.fechaEmision}">
											<f:convertDateTime pattern="yyyy-MM-dd" />
										</h:outputText>
									</center>
								</rich:column>
								<rich:column id="colEnEmiNroDoc" headerClass="dataTableHeader" width="11%" sortable="true" sortBy="#{itemComprobante.enEmiNroDoc}"
									sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
									<f:facet name="header">
										<h:outputText value="RUC" />
									</f:facet>
									<center>
										<h:outputText value="#{itemComprobante.proNroDocumento}" />
									</center>
								</rich:column>
								<rich:column id="colEnEmiRazonSocial" headerClass="dataTableHeader" width="30%" sortable="true" sortBy="#{itemComprobante.enEmiRazonSocial}"
									sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
									<f:facet name="header">
										<h:outputText value="Razón Social" />
									</f:facet>
									<center>
										<h:outputText value="#{itemComprobante.proRazonSocial}" />
									</center>
								</rich:column>
								<rich:column id="colEnNroComprobante" headerClass="dataTableHeader" width="15%" sortable="true" sortBy="#{itemComprobante.enNroComprobante}"
									sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
									<f:facet name="header">
										<h:outputText value="Nro. Certificado" />
									</f:facet>
									<center>
										<h:outputText value="#{itemComprobante.nroComprobanteEle}" />
									</center>
								</rich:column>
								<rich:column id="colEnRetPerMoneda" headerClass="dataTableHeader" width="14%" sortable="true" sortBy="#{itemComprobante.enRetPerMoneda}">
									<f:facet name="header">
										<h:outputText value="Moneda Pago" />
									</f:facet>
									<center>
										<h:outputText value="#{itemComprobante.monedaPago}" />
									</center>
								</rich:column>
								<rich:column id="colEnRetPerImporteRetenidoPercibido" headerClass="dataTableHeader" width="16%" sortable="true"
									sortBy="#{itemComprobante.enRetPerImporteRetenidoPercibido}">
									<f:facet name="header">
										<h:outputText value="Importe Retenido" />
									</f:facet>
									<center>
										<h:outputText value="#{itemComprobante.importeRetper}" style="float:right">
											<f:convertNumber locale="en_US" minFractionDigits="2" />
										</h:outputText>
									</center>
								</rich:column>
							</rich:extendedDataTable>
						</div>
						<br />
						<h:outputText id="numRegEncontrados" style="font-weight:bold;"
							value="N° de Registros Encontrados: #{null != genReversaComprobantesController.listaCertRetencionReversa ? genReversaComprobantesController.listaCertRetencionReversa.size() : 0}" />
					</rich:panel>

					<div align="right">
						<table border="0" cellpadding="0" cellspacing="0">
							<tr align="right">
								<td><h:commandButton id="generarTXT" action="#{genReversaComprobantesController.generarTXT}" value="> Generar TXT"
										style="margin-top: 10px;" disabled="#{genReversaComprobantesController.disabledBtnGenerarTXT}" render="true" reRender="pnlLista, generarTXT" />
								</td>
							</tr>
						</table>
					</div>
				</h:form>
			</fieldset>
		</center>
	</rich:panel>
</body>
</html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich" xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets">

<a4j:keepAlive beanName="feedBackTlmkController" ajaxOnly="true" />

<head>
<script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/js/validacion.js" />
<style type="text/css">
.celda {
	width: 170px;
	color: #000;
}

.datatable {
	padding-top: 10px;
}

body {
	font-family: Monaco, Georgia, Times, serif;
}

.separador {
	padding: 10px 9px;
}
</style>
</head>
<body>
	<h:form>
		<div>
			<rich:panel styleClass="wizard">
				<f:facet name="header">
					<h:outputText value="Telemarketing > FeedBack Telemarketing" />
				</f:facet>
				<center>
					<fieldset>
						<table>
							<tr>
								<td style="text-align: right;"><rich:message for="selectSocioBase" style="color: red;">
										<f:facet name="errorMarker">
											<h:graphicImage url="../imagenes/error.png" />
										</f:facet>
									</rich:message> <rich:spacer width="5"></rich:spacer> <h:outputText value="Socio Base:" /></td>
								<td style="text-align: left;"><h:selectOneMenu id="selectSocioBase" class="celda" value="#{feedBackTlmkController.codSocio}"
										required="true" requiredMessage="Obligatorio" valueChangeListener="#{feedBackTlmkController.buscarBases}">
										<f:selectItems value="#{feedBackTlmkController.socioItems}" />
										<a4j:support event="onchange" ajaxOnly="true" reRender="listaBases" />
									</h:selectOneMenu></td>
							</tr>
						</table>
						<br />
						<rich:extendedDataTable id="listaBases" var="baseCabecera" value="#{feedBackTlmkController.listaBaseCabecera}" width="750px" height="300px"
							selection="#{feedBackTlmkController.selection}" selectionMode="single" reRender="true">

							<rich:column headerClass="dataTableHeader">
								<f:facet name="header">
									<h:outputText value="Cod. Base" />
								</f:facet>
								<center>
									<h:outputText value="#{baseCabecera.codBase}" />
								</center>
							</rich:column>
							<rich:column headerClass="dataTableHeader">
								<f:facet name="header">
									<h:outputText value="Cod. Socio" />
								</f:facet>
								<center>
									<h:outputText value="#{baseCabecera.codSocio}" />
								</center>
							</rich:column>
							<rich:column headerClass="dataTableHeader">
								<f:facet name="header">
									<h:outputText value="Cant. Registros" />
								</f:facet>
								<center>
									<h:outputText value="#{baseCabecera.numRegistros}" />
								</center>
							</rich:column>
							<rich:column headerClass="dataTableHeader">
								<f:facet name="header">
									<h:outputText value="Sequence Cardif" />
								</f:facet>
								<center>
									<h:outputText value="#{baseCabecera.sequenceFileNumber}" />
								</center>
							</rich:column>
							<rich:column headerClass="dataTableHeader">
								<f:facet name="header">
									<h:outputText value="Estado" />
								</f:facet>
								<center>
									<h:outputText value="#{baseCabecera.estado}" />
								</center>
							</rich:column>
							<rich:column headerClass="dataTableHeader">
								<f:facet name="header">
									<h:outputText value="Usuario Proceso" />
								</f:facet>
								<center>
									<h:outputText value="#{baseCabecera.usuCreacion}" />
								</center>
							</rich:column>
							<rich:column headerClass="dataTableHeader">
								<f:facet name="header">
									<h:outputText value="Fecha Proceso" />
								</f:facet>
								<center>
									<h:outputText value="#{baseCabecera.fecCreacion}">
										<f:convertDateTime timeZone="America/Lima" pattern="dd/MM/yyyy HH:mm:ss"></f:convertDateTime>
									</h:outputText>
								</center>
							</rich:column>
						</rich:extendedDataTable>
					</fieldset>
					<table>
						<tr>
							<td style="height: 10px;"></td>
						</tr>
						<tr>
							<td><a4j:commandButton action="#{feedBackTlmkController.generarFeedBack}"
									oncomplete="#{facesContext.maximumSeverity == null ? 'Richfaces.showModalPanel(\'panel\')' : ';'}" value="Generar FeedBack" reRender="panel" /></td>
						</tr>
					</table>
				</center>



			</rich:panel>
		</div>
	</h:form>

</body>

<rich:modalPanel id="panel" autosized="true">
	<f:facet name="header">
		<h:outputText value="Ejecucion del Proceso" />
	</f:facet>
	<f:facet name="controls">
		<h:panelGroup>
			<h:graphicImage value="/imagenes/close.gif" styleClass="hidelink" id="hidelink" />
			<rich:componentControl for="panel" attachTo="hidelink" operation="hide" event="onclick" />
		</h:panelGroup>
	</f:facet>
	<h:form>
		<a4j:region>
			<a4j:include viewId="/paginas/ok.xhtml" />
		</a4j:region>
	</h:form>
</rich:modalPanel>

</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://richfaces.org/a4j">
<a4j:keepAlive beanName="configuracionNuevoSocioController" />
<head>
<style type="text/css">
.celda {
	width: 150px;
	color: #000;
}

.datatable {
	padding-top: 10px;
}
input[type="submit"], input[type="button"]{cursor: pointer;}
body {
	font-family: Monaco, Georgia, Times, serif;
}

</style>
<script type="text/javascript">

function validar(){
	var length=document.querySelectorAll('.rich-message-marker').length;
	console.info(length);
	return length==0;
}

function validarRuc(){
	
// 	alert(document.getElementById("#{rich:clientId('idMsjValidarRuc')}").innerHTML);

	var msjError = document.getElementById("#{rich:clientId('idMsjValidarRuc')}").innerHTML;

	var length = document.querySelectorAll('.rich-message-marker').length;
	
	if(length==0){
		if(msjError.length == 0){
			Richfaces.hideModalPanel('panelMantenimietoNunevo');
		}
	}

	
}


function validarRucM(){
	
// 	alert(document.getElementById("#{rich:clientId('idMsjValidarRuc')}").innerHTML);

	var msjError = document.getElementById("#{rich:clientId('idMsjValidarRucM')}").innerHTML;

	var length = document.querySelectorAll('.rich-message-marker').length;
	
	if(length==0){
		if(msjError.length == 0){
			Richfaces.hideModalPanel('panelMantenimieto');
		}
	}

	
}


</script>
<script type="text/javascript"
	src="#{facesContext.externalContext.requestContextPath}/js/validacion.js" />

</head>
<body>
	
		<rich:panel id="NuevoSocio" height="100%">
			<f:facet name="header">
				<h:outputText value="Suscripción > Configuración Nuevo Socio">
				</h:outputText>
			</f:facet>
			<center>
				<h:form>
			
				<fieldset id="nuevoSocio">
					
					<table border="0" width="800px">
						<tr>
									<td>
										<rich:message	for="ruc" style="color: red;">
											<f:facet name="errorMarker">
												<h:graphicImage url="../imagenes/error.png" />
											</f:facet>
										</rich:message> 
										<h:outputText value=" RUC:" />
									</td>
									<td>
										<h:inputText id="ruc"
													 style="width:205px;"
													 onkeypress="return valNumeros(event);" 													 
													 value="#{configuracionNuevoSocioController.ruc}"
													 maxlength="11" />
									</td>
									<td>
										<rich:message	for="socio" style="color: red;">
											<f:facet name="errorMarker">
												<h:graphicImage url="../imagenes/error.png" />
											</f:facet>
										</rich:message> 
										<h:outputText value=" Razón Social:" />
									
									</td>
									
									<td>
										<h:inputText id="socio" value="#{configuracionNuevoSocioController.socio}"
										             maxlength="100"										            
										             onkeyup="value=value.toUpperCase();"
										             />
									</td>									
									<td>
										<a4j:commandButton value="Buscar" action="#{configuracionNuevoSocioController.buscarSocio}" 
										                   reRender="tablaSocios, nroRegistros" rendered="true" />							
									</td>
								</tr>
					</table>
					<br />
			
					<div style="width: 800px; border: 0px solid white;">
						<rich:extendedDataTable id="tablaSocios" var="objsocio"
							value="#{configuracionNuevoSocioController.listaSocio}"
							width="800px" height="300px" rows="10"
							selection="#{configuracionNuevoSocioController.seleccionSocio}"
							selectionMode="single" reRender="true">
							<a4j:support id="selectionBtnEliminar"
								action="#{configuracionNuevoSocioController.onSelectionChanged}"
								event="onselectionchange" reRender="panelMantenimieto,btnModificarP" ajaxSingle="true"/> 
							<rich:column id="colId" headerClass="dataTableHeader" width="40"
								sortable="true" sortBy="#{objsocio.id}"
								sortIconAscending="dataTableAscIcon"
								sortIconDescending="dataTableDescIcon">
								<f:facet name="header">
									<h:outputText value="Id" />
								</f:facet>
								<center>
									<h:outputText value="#{objsocio.secuencial}" />
								</center>
							</rich:column>
							<rich:column id="colArchivo" headerClass="dataTableHeader"
								width="250" sortable="true" sortBy="#{objsocio.rucSocio}"
								sortIconAscending="dataTableAscIcon"
								sortIconDescending="dataTableDescIcon">
								<f:facet name="header">
									<h:outputText value="Ruc" />
								</f:facet>
								<center>
									<h:outputText value="#{objsocio.rucSocio}" />
								</center>
							</rich:column>
							<rich:column id="colFecCarga" headerClass="dataTableHeader"
								width="150" sortable="true" sortBy="#{objsocio.nombreSocio}"
								sortIconAscending="dataTableAscIcon"
								sortIconDescending="dataTableDescIcon">
								<f:facet name="header">
									<h:outputText value="Razón Social" />
								</f:facet>
								<center>
									<h:outputText value="#{objsocio.nombreSocio}">
										
									</h:outputText>
								</center>
							</rich:column>
							<rich:column id="colRegistros" headerClass="dataTableHeader"
								width="160" sortable="true"
								sortBy="#{objsocio.abreviatura}"
								sortIconAscending="dataTableAscIcon"
								sortIconDescending="dataTableDescIcon">
								<f:facet name="header">
									<h:outputText value="Abreviatura" />
								</f:facet>
								<center>
									<h:outputText value="#{objsocio.abreviatura}">
									</h:outputText>
								</center>
							</rich:column>
							
							<rich:column id="colEstado" headerClass="dataTableHeader"
								width="200" sortable="true"
								sortBy="#{objsocio.fechaContratos}"
								sortIconAscending="dataTableAscIcon"
								sortIconDescending="dataTableDescIcon">
								<f:facet name="header">
									<h:outputText value="Fecha Inicio Contrato" />
								</f:facet>
								<center>
									<h:outputText value="#{objsocio.fechaContratos}" >
										<f:convertDateTime pattern="yyyy-MM-dd" />
									</h:outputText>
								</center>
							</rich:column>
							
							<f:facet name="footer">
								<rich:datascroller id="ds" for="tablaSocios" maxPages="10" page="#{configuracionNuevoSocioController.nroPaginaGrilla}"></rich:datascroller>
							</f:facet>
						</rich:extendedDataTable>
						<br/>  
						<div class="contadorRegistros" style="margin: auto; text-align: center; font-weight: bold; padding: 12px 10px 0px;">
							<h:outputText id="nroRegistros" value="N° de Registros encontrados: #{configuracionNuevoSocioController.numeroSocios}" />
					    </div>
						
						<br />
						<table border="0" width="800px">
							<tr>
								<td width="150"></td>
								<td width="150" style="text-align: right;"><a4j:commandButton id="btnModificarP" style="width:100px" value="Modificar Socio" oncomplete="#{rich:component('panelMantenimieto')}.show();return false"  disabled="#{!configuracionNuevoSocioController.flagBtnModificarSocio}"  reRender="true"/></td>
								<td width="150" style="text-align: left;"><a4j:commandButton id="btnNuevo"  value="Nuevo Socio" style="width:100px" oncomplete="#{rich:component('panelMantenimietoNunevo')}.show();return false" 
																				action="#{configuracionNuevoSocioController.btnLimpiarCamposNuevoSocio}"  reRender="NuvcamposSocio" /></td>
								<td width="150" style="text-align: right;"><a4j:commandButton id="btnContinuar"  value=" Configurar socio canal >> "   action="#{configuracionNuevoSocioController.siguienteSocioProducto}" oncomplete="#{facesContext.maximumSeverity == null ? 'Richfaces.hideModalPanel(\'panel\')' : ';'}" reRender="tablaSocios"/></td>
							</tr>
						</table>
						
						<br />
					
					</div>
					<br />

					
				</fieldset>
				</h:form>
			</center>
		</rich:panel>
		
		
<!-- modal modifica  inicio -->		
	<rich:modalPanel id="panelMantenimieto" autosized="true">
		<f:facet name="header">
			<h:outputText value="Modificar Socio" />
		</f:facet>
		<f:facet name="controls">
			<h:panelGroup>
				<h:graphicImage value="/imagenes/close.gif" styleClass="hidelink" id="hidelinkAnular" />
				<rich:componentControl for="panelMantenimieto" attachTo="hidelinkAnular" operation="hide" event="onclick" />
			</h:panelGroup>
		</f:facet>
		<h:form>
			<a4j:region>

				<h:panelGrid>
					<a4j:outputPanel id="camposSocio">
						<table width="350px">

							<tr>
								<td style="width: 130px;">
										<rich:message	for="ruc" style="color: red;">
											<f:facet name="errorMarker">
												<h:graphicImage url="../imagenes/error.png" />
											</f:facet>
										</rich:message> 
										<h:outputText value="* Ruc:" />
								</td>
								<td><h:inputText id="ruc"
													 onkeypress="return valNumeros(event);" 
													 required="true"
													 value="#{configuracionNuevoSocioController.selectSocio.rucSocio}"
													 requiredMessage=""
													 maxlength="11"/>
								</td>
							</tr>
							<tr>
								<td style="width: 130px;">
									<rich:message	for="razonSocial" style="color: red;">
											<f:facet name="errorMarker">
												<h:graphicImage url="../imagenes/error.png" />
											</f:facet>
									</rich:message> 
									<h:outputText value="* Razón Social:" />
								
								
								</td>
								<td>
								<h:inputText id="razonSocial"
												  	 value="#{configuracionNuevoSocioController.selectSocio.nombreSocio}" 
													 required="true"
													 requiredMessage=""
													 maxlength="100"
										             onkeyup="value=value.toUpperCase();"
													 />
							 	</td>
							</tr>
							<tr>
								<td style="width: 130px;">
								
									<rich:message	for="abreviatura" style="color: red;">
											<f:facet name="errorMarker">
												<h:graphicImage url="../imagenes/error.png" />
											</f:facet>
									</rich:message> 
									<h:outputText value="* Abreviatura:" />
									
								</td>
								<td><h:inputText id="abreviatura"
													 value="#{configuracionNuevoSocioController.selectSocio.abreviatura}"
													 required="true"
													 requiredMessage=""
										             onkeyup="value=value.toUpperCase();"
										             maxlength="10"    
													   /></td>
							</tr>
						
							<tr>
							<td style="width: 130px;">
									<rich:message	for="modulo" style="color: red;">
											<f:facet name="errorMarker">
												<h:graphicImage url="../imagenes/error.png" />
											</f:facet>
									</rich:message> 
									<h:outputText value="Grupo de Comercialización SOAT :" />
								</td>
							<td> 
									<h:selectBooleanCheckbox  id="modulo"  value="#{configuracionNuevoSocioController.checkBoxGrupo}"  
									                          valueChangeListener="#{configuracionNuevoSocioController.grupoModfChangeListener}" >
										<a4j:support event="onchange"  reRender="fechalebel,divCalendar,fechatext"  ajaxSingle="true"   />  
									</h:selectBooleanCheckbox> 
							 </td>
							</tr>
							<tr>
								<td style="width: 130px;">
									<h:outputText id="fechalebel" value=" Fecha Inicio Contrato:"  style="display:#{(configuracionNuevoSocioController.flagModfcheckBoxGrupo==true) ? 'block' : 'none'}" />
								</td>
								<td>
								 <h:panelGrid id="divCalendar" style="display:#{(configuracionNuevoSocioController.flagModfcheckBoxGrupo==true) ? 'block' : 'none'}"> 
										<rich:calendar  id="fechatext" enableManualInput="true"																				
													datePattern="dd/MM/yyyy"
													value="#{configuracionNuevoSocioController.selectSocio.fechaContratos}"
													popup="true"													
													showWeeksBar="false">
													 <a4j:support ajaxSingle="true" event="ondateselected"/> 	
										</rich:calendar>
								</h:panelGrid> 
								</td>
							</tr>	
							
							<tr>
							<td colspan="2">
								<div style="color:red; text-align:center;">
									<h:outputText id="idMsjValidarRucM" value="#{configuracionNuevoSocioController.msjValidarRuc}"/>
								</div>
							</td>
							</tr>					
						</table>
					</a4j:outputPanel>
				</h:panelGrid>
				<center>
					<h:panelGrid columns="2">
						<a4j:commandButton id="btnModificar" value="Guardar" reRender="tablaSocios, btnModificarP, idMsjValidarRucM, nroRegistros"   action="#{configuracionNuevoSocioController.btnModificarSocio}" oncomplete="validarRucM();"/>
						<a4j:commandButton id="btnCancelar" value="Cancelar" oncomplete="#{rich:component('panelMantenimieto')}.hide()" /> 
					</h:panelGrid>
				</center>
			</a4j:region>
		</h:form>
	</rich:modalPanel>
<!-- modal modifica  fin -->		
	
<!-- modal nuevo inicio -->

<rich:modalPanel id="panelMantenimietoNunevo" autosized="true">
		<f:facet name="header">
			<h:outputText value="Nuevo Socio" />
		</f:facet>
		<f:facet name="controls">
			<h:panelGroup>
				<h:graphicImage value="/imagenes/close.gif" styleClass="hidelink" id="hidelinkSocio" />
				<rich:componentControl for="panelMantenimietoNunevo" attachTo="hidelinkSocio" operation="hide" event="onclick" />
			</h:panelGroup>
		</f:facet>
		<h:form>
			<a4j:region>

				<h:panelGrid>
					<a4j:outputPanel id="NuvcamposSocio">
						<table width="350px">

							<tr>
								<td style="width: 130px;">
										<rich:message	for="Nuvruc" style="color: red;">
											<f:facet name="errorMarker">
												<h:graphicImage url="../imagenes/error.png" />
											</f:facet>
										</rich:message> 
										<h:outputText value=" Ruc:" />
								</td>
								<td><h:inputText id="Nuvruc"
													 onkeypress="return valNumeros(event);" 
													 required="true"
													 value="#{configuracionNuevoSocioController.nuevoSocio.rucSocio}"
													 requiredMessage=""
													 maxlength="11"/>
								</td>
							</tr>
							<tr>
								<td style="width: 130px;">
										<rich:message	for="NuvrazonSocial" style="color: red;">
											<f:facet name="errorMarker">
												<h:graphicImage url="../imagenes/error.png" />
											</f:facet>
										</rich:message> 
										<h:outputText value=" Razon Social:" />		
								</td>
								<td>
										<h:inputText id="NuvrazonSocial"
												  	 value="#{configuracionNuevoSocioController.nuevoSocio.nombreSocio}" 
													 required="true"
													 requiredMessage=""
													 maxlength="100"  
										             onkeyup="value=value.toUpperCase();"
													 />
							 	</td>
							</tr>
							<tr>
								<td style="width: 130px;">
									<rich:message	for="Nuvabreviatura" style="color: red;">
											<f:facet name="errorMarker">
												<h:graphicImage url="../imagenes/error.png" />
											</f:facet>
										</rich:message> 
										<h:outputText value=" Abreviatura:" />	
								</td>
								<td><h:inputText id="Nuvabreviatura"
													 value="#{configuracionNuevoSocioController.nuevoSocio.abreviatura}"
													 required="true"
													 requiredMessage=""  
													 onkeypress="return valRegExpEspeciales(event);"
										             onkeyup="value=value.toUpperCase();"
										             maxlength="10"/></td>
							</tr>
							
							<tr>
							<td style="width: 130px;">
									<rich:message	for="Nuvmodulo" style="color: red;">
											<f:facet name="errorMarker">
												<h:graphicImage url="../imagenes/error.png" />
											</f:facet>
									</rich:message> 
									<h:outputText value=" Grupo de Comercialización SOAT :" />	
							</td>
							<td> 
									<h:selectBooleanCheckbox  id="Nuvmodulo"  value="#{configuracionNuevoSocioController.checkBoxGrupoNuevo}"  valueChangeListener="#{configuracionNuevoSocioController.grupoNvoChangeListener}" immediate="true">
										<a4j:support event="onchange"  reRender="Nuvfechalebel,Nuvfechatext" ajaxSingle="true" > </a4j:support>
									</h:selectBooleanCheckbox> 
							 </td>
							</tr>
							
							<tr >
								<td style="width: 130px;">
									<h:outputText id="Nuvfechalebel" value=" Fecha Inicio Contrato:"  rendered="true" 	style="display:#{(configuracionNuevoSocioController.flagNvocheckBoxGrupo == true) ? 'block' : 'none'}"  />
								</td>							
								<td>
												<h:panelGrid  id="Nuvfechatext" style="display:#{(configuracionNuevoSocioController.flagNvocheckBoxGrupo == true) ? 'block' : 'none'}">
												<rich:calendar id="idcalendarionuevo"    
													enableManualInput="false"	
													datePattern="dd/MM/yyyy"
													rendered="true"
													value="#{configuracionNuevoSocioController.nuevoSocio.fechaContratos}"
													showWeeksBar="false"  />
													<a4j:support ajaxSingle="true" event="ondateselected"/>  
												</h:panelGrid>
								</td>
							</tr>
							<tr>
							<td colspan="2">
								<div style="color:red; text-align:center;">
									<h:outputText id="idMsjValidarRuc" value="#{configuracionNuevoSocioController.msjValidarRuc}"/>
								</div>
							</td>
							</tr>
						
						</table>
					</a4j:outputPanel>
				</h:panelGrid>
				<center>
					<h:panelGrid columns="2">
						<a4j:commandButton id="btnNuvAnular" value="Guardar"  reRender="tablaSocios, idMsjValidarRuc, nroRegistros, btnModificarP" oncomplete="validarRuc();" action="#{configuracionNuevoSocioController.btnnuevoSocio}"  />
						<a4j:commandButton id="btnNuvCancelar" value="Cancelar" oncomplete="#{rich:component('panelMantenimietoNunevo')}.hide()" ajaxSingle="true" 
											reRender="NuvcamposSocio"/>
					</h:panelGrid>
				</center>
			</a4j:region>
		</h:form>
	</rich:modalPanel>

<script type="text/javascript" language="javascript">		
			function valRegExpEspeciales(evt){
				
					var respuesta = true;
					//evt = window.event || evt;
					evt = e ? e : event;
					var key = window.Event ? evt.which : evt.keyCode;
					var charCode = evt.which || evt.keyCode;
					var charStr = String.fromCharCode(charCode);

					var extraCaracteres = /[A-z\\s-ñáéíóúÑÁÉÍÓÚ.:0-9]/
					// /[A-z\\s-ñáéíóúÑÁÉÍÓÚ.:0-9]/i.test(charStr)
					if (evt.keyCode==8 || evt.keyCode==46 ||  evt.keyCode==32) {
						respuesta = true;   
					}else{
						respuesta = false;
					}

				
					
					return respuesta;

			}
			
		</script>
<!-- modal nuevo fin -->	
</body>
</html>
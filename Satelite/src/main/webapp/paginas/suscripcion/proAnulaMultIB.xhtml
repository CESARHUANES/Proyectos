<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:a4j="http://richfaces.org/a4j" xmlns:rich="http://richfaces.org/rich">
<a4j:keepAlive beanName="proAnulaMultIBController" />

<style type="text/css">
.ipt {
	/* 	margin: 0px 8px 0px 8px; */
	padding: 0px;
	width: 186px;
}

.boton {
	font-size: 10px;
	font-family: Verdana, Helvetica;
	font-weight: bold;
	color: white;
	background: #638cb5;
	border: 0px;
	width: 80px;
	height: 19px;
}

.custom-input-file .input-file {
	margin: 0;
	padding: 0;
	outline: 0;
	font-size: 10000px;
	border: 10000px solid transparent;
	opacity: 0;
	filter: alpha(opacity =   0);
	position: absolute;
	right: -1000px;
	top: -1000px;
	cursor: pointer;
}
</style>
<head>
</head>
<body>
	<h:form>

		<rich:panel id="palista" height="100%">
			<f:facet name="header">
				<h:outputText value="Suscripcion > Procesar Anulaciones Multiproteccion IB" />
			</f:facet>
			<br />






			<center>
				<rich:message for="periodo" style="color: red;">
					<f:facet name="errorMarker">
						<h:graphicImage url="../imagenes/error.png" />
					</f:facet>
				</rich:message>
				<rich:spacer width="5"></rich:spacer>
				<table>
					<tr>
						<td><h:outputText value="* Periodo (AAAAMM): " /></td>
						<td><h:inputText id="periodo" value="#{proAnulaMultIBController.periodo}" maxlength="6" class="celda" onkeyup="value=value.toUpperCase()"
								onkeydown="return valNumerosLetras(event)" requiredMessage="Periodo Obligatorio" required="true" /></td>
					</tr>
				</table>
			</center>


			<table align="center">
				<tr>
					<td><rich:fileUpload id="uploader" align="left" disabled="#{proAnulaMultIBController.upload}"
							fileUploadListener="#{proAnulaMultIBController.listener}" autoclear="false" acceptedTypes="txt,xlsx" maxFilesQuantity="1" allowFlash="false"
							addControlLabel="Seleccionar Archivo .txt .xlsx" clearAllControlLabel="Limpiar" clearControlLabel="proAnulaMultIBController.clear"
							stopEntryControlLabel="Detener Proceso" uploadControlLabel="Cargar Archivo" value="{_MB}MB from {MB}MB cargando --- {mm}:{ss}"
							listHeight="50px" listWidth="345px">
							<a4j:support event="onclear" action="#{proAnulaMultIBController.clear}" reRender="uploader" />
							<a4j:support event="onuploadcomplete" reRender="btnIngresar,btnIngresarMes" />
						</rich:fileUpload></td>

				</tr>
			</table>

			<!-- 				<a4j:region ajaxOnly="true"> -->

			<center>
				<table>
					<tr>
						<td><a4j:commandButton id="btnIngresar" reRender="listaAnul" value="Cargar Anulación Diaria" style="width:165px"
								action="#{proAnulaMultIBController.registroDiario}"
								onclick="if(!confirm('Esta seguro que desea Continuar?\n\nAsegúrece que el archivo cargado\ntenga el formato correcto si es asi\npuede continuar.')){return false;}"></a4j:commandButton>


							<rich:spacer width="18"></rich:spacer> <a4j:commandButton id="btnIngingresarTramaMesresarMes" value="Cargar Anulación Mensual"
								style="width:165px" action="#{proAnulaMultIBController.ingresarTramaMes}"
								onclick="if(!confirm('Esta seguro que desea Continuar?\n\nAsegúrece que el archivo cargado\ntenga el formato correcto si es asi\npuede continuar.')){return false;}"
								reRender="lista,listaAnul"></a4j:commandButton></td>
					</tr>
				</table>
			</center>





			<br />

			<center>
				<rich:extendedDataTable id="listaAnul" var="varlista" value="#{proAnulaMultIBController.lista}" width="840px" rows="8" height="288px"
					selectionMode="single" selection="#{proAnulaMultIBController.selection}" action="#{proAnulaMultIBController.openTask}">

					<a4j:support id="idSel" action="#{proAnulaMultIBController.cambiarPeriodo}" event="onselectionchange" reRender="periodo" />

					<rich:column id="archivoOriginal" headerClass="dataTableHeader" width="120" sortable="true" sortBy="varlista.periodo"
						sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
						<f:facet name="header">
							<h:outputText value="Periodo" />
						</f:facet>
						<center>
							<h:outputText value="#{varlista.periodo}" />
						</center>
					</rich:column>

					<rich:column id="codigoTrama" headerClass="dataTableHeader" width="140" sortable="true" sortBy="varlista.codTrama"
						sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">

						<f:facet name="header">
							<h:outputText value="N° de Registros" />
						</f:facet>

						<center>
							<h:outputText value="#{varlista.canRegistros}" />
						</center>
					</rich:column>


					<rich:column id="cantidadRechazados" headerClass="dataTableHeader" width="140" sortable="true" sortBy="varlista.canRechazados"
						sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
						<f:facet name="header">
							<h:outputText value="N° de Rechazados" />
						</f:facet>
						<center>
							<h:outputText value="#{varlista.canRechazados}" />
						</center>
					</rich:column>



					<rich:column id="poliza" headerClass="dataTableHeader" width="160" sortable="true" sortBy="varlista.usuCreacion"
						sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
						<f:facet name="header">
							<h:outputText value="Usuario Creacion" />
						</f:facet>
						<center>
							<h:outputText value="#{varlista.usuCreacion}" />
						</center>
					</rich:column>
					<rich:column id="documento" headerClass="dataTableHeader" width="170" sortable="true" sortIconAscending="dataTableAscIcon"
						sortIconDescending="dataTableDescIcon" sortBy="varlista.fecCarga">
						<f:facet name="header">
							<h:outputText value="Fecha de Carga" />
						</f:facet>
						<center>

							<h:outputText value="#{varlista.fecCarga}">
								<f:convertDateTime pattern="yyyy-MM-dd" />
							</h:outputText>
						</center>
					</rich:column>

					<rich:column id="cliente" headerClass="dataTableHeader" width="110" sortable="true" sortIconAscending="dataTableAscIcon"
						sortIconDescending="dataTableDescIcon" sortBy="varlista.estado">
						<f:facet name="header">
							<h:outputText value="Estado" />
						</f:facet>
						<center>
							<h:outputText value="#{varlista.estado} " />
						</center>
					</rich:column>

					<f:facet name="footer">
						<rich:datascroller id="ds" for="listaAnul" maxPages="2"></rich:datascroller>
					</f:facet>
				</rich:extendedDataTable>
			</center>



			<center>
				<table>
					<tr>
						<td><h:commandButton action="#{proAnulaMultIBController.exportarMes}" value="  Generar Archivo Anulacion ">

								<a4j:support event="ondblclick" reRender="listaAnul" oncomplete="#{rich:component('listaAnul')}.reload()" ajaxOnly="true" />
							</h:commandButton> <!-- <a4j:commandButton id="button" action="#{proAnulaMultIBController.exportarMes}" value=" Generar Archivo Anulacion " 
									oncomplete="#{facesContext.maximumSeverity == null ? 'window.open(\'suscripcion/genArchivoAnul.jsf\',\'blankPopUp\',\'status=no,toolbar=no,location=no,menubar=no,resizable,width=200,height=150,scrollbars,left=100,top=100\');' : ';'}"
									style="height: 22px; width : 187px;" reRender="listaAnul">
								</a4j:commandButton> --></td>
						<td><a4j:commandButton id="btnEditar" action="#{proAnulaMultIBController.listarDetalle}"
								oncomplete="#{facesContext.maximumSeverity == null ? 'Richfaces.showModalPanel(\'panelDetalle\')' : ';'}" value="Ver Detalle"
								reRender="panelDetalle" /></td>

					</tr>
				</table>

			</center>
			<!-- </a4j:region>	 -->


		</rich:panel>

	</h:form>
</body>






<rich:modalPanel id="panelDetalle" autosized="true">
	<f:facet name="header">
		<h:outputText value="Anulacion>Detalle" />
	</f:facet>
	<f:facet name="controls">
		<h:panelGroup>
			<h:graphicImage value="/imagenes/close.gif" styleClass="hidelink" id="hidelink" />
			<rich:componentControl for="panelDetalle" attachTo="hidelink" operation="hide" event="onclick" />
		</h:panelGroup>
	</f:facet>
	<h:form>
		<a4j:region>
			<a4j:include viewId="/paginas/suscripcion/detaAnulacionSus.xhtml" />
		</a4j:region>
	</h:form>
</rich:modalPanel>
<rich:modalPanel id="cargando" width="250" height="130">
	<f:facet name="header">Informativo</f:facet>
	<h:panelGroup>
		<center>
			<h5>El proceso se está ejecutando, consulte en la tabla de procesos.</h5>
			<a4j:commandButton value="Aceptar" onclick="#{rich:component('cargando')}.hide();return false" />
			<rich:componentControl for="cargando" attachTo="hidelink" operation="hide" event="onclick"></rich:componentControl>
		</center>
	</h:panelGroup>
</rich:modalPanel>




<rich:modalPanel id="ventana2" width="250" height="130">
	<f:facet name="header">Generacion de Archivo</f:facet>
	<h:panelGroup>
		<center>
			<h5>El proceso se está ejecutando, consulte en la tabla de procesos.</h5>
			<a4j:commandButton value="Aceptar" onclick="#{rich:component('cargando')}.hide();return false" />

			<rich:componentControl for="cargando" attachTo="hidelink" operation="hide" event="onclick"></rich:componentControl>
		</center>
	</h:panelGroup>
</rich:modalPanel>


</html>
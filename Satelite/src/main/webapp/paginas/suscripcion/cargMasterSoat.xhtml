<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich" xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets">

<a4j:keepAlive beanName="cargMasterSoatController" />
<head>
<script type="text/javascript" src="#{facesContext.externalContext.requestContextPath}/js/validacion.js" />
<style type="text/css">
.celda {
	width: 130px;
	color: #000;
}

.datatable {
	padding-top: 10px;
}

body, html {
	font-family: Monaco, Georgia, Times, serif;
	width: 100%;
	height: 100%;
}

.separador {
	padding: 0;
	margin: 0 2px;
	float: right;
}

#consultar {
	text-align: left;
}

#formVehiculo {
	width: 1000px;
	margin: 0 auto;
	color:
}
</style>
<script type="text/javascript">

function validarMasterSoat(){
	
// 	alert(document.getElementById("#{rich:clientId('idMsjValidarRuc')}").innerHTML);

	var msjError = document.getElementById("#{rich:clientId('idMsjValidarMaster')}").innerHTML;

	var length = document.querySelectorAll('.rich-message-marker').length;
	
	if(length==0){
		if(msjError.length == 0){
			Richfaces.hideModalPanel('panelMantenimiento');
		}
	}

	
}
</script>
</head>
<body>

		<rich:panel id="consultar" height="100%" reRender="lista">
			<f:facet name="header">
				<h:outputText value="Suscripción > SOAT > Carga Master SOAT" />
			</f:facet>
			<center>
				<fieldset id="formVehiculo">
					<div style="text-align: center;">
					<h:form>
						<table style="margin: auto;" border="0">
							<tr>	
							<td>
										<rich:message	for="idsocio" style="color: red;">
											<f:facet name="errorMarker">
												<h:graphicImage url="../imagenes/error.png" />
											</f:facet>
										</rich:message> 
									<h:outputText value="Socio: " />
									</td>						
								
																												
								<td style="width: 15%; text-align: left;">

									<h:selectOneMenu id="idsocio" value="#{cargMasterSoatController.idsocio}" style=" width:207px;"
									                 required="true" requiredMessage="">

											<f:selectItems value="#{cargMasterSoatController.tipoSocioItems}" />
											<a4j:support event="onchange" />
									</h:selectOneMenu>
								</td>
										
										
								<td>
										<rich:message	for="fechaVigencia" style="color: red;">
											<f:facet name="errorMarker">
												<h:graphicImage url="../imagenes/error.png" />
											</f:facet>
										</rich:message> 
										
									
									</td>
													
								<td>

									<h:outputText value="Fecha Inicio Vigencia: " />								
								</td>
								
								
									
								<td>
									<rich:calendar id="fechaVigencia" enableManualInput="false" datePattern="dd/MM/yyyy"
												   value="#{cargMasterSoatController.fechaVigencia}" showWeeksBar="false" 
												    inputStyle="width: 125px;">
									</rich:calendar>
								</td>
							
									<td>

									<h:outputText value="Fecha Carga: " />								
								</td>
									
								<td>
									<rich:calendar id="fechaCarga" enableManualInput="false" datePattern="dd/MM/yyyy"
										           value="#{cargMasterSoatController.fechaCarga}" showWeeksBar="false" 
										           inputStyle="width: 125px;">
									</rich:calendar>
								</td>
						
								
							</tr>
							<tr>
								<td colspan="10" height="5px"></td>
							</tr>
							<tr>
								<td colspan="10" style="text-align: right;">
									<a4j:commandButton action="#{cargMasterSoatController.btnConsultarCargaMaster}" value="Buscar"
													  reRender="lista,nroRegistros, cargarMaster" id="buscarp" />
								</td>
							</tr>
						</table> 
						</h:form>
						
						
					</div>
					<h:form id="bandeja">
					<div class="datatable">
						<div style="scrollbar-base-color: #3d8a3d; width: 950px; border: 0px solid white; overflow-x: scroll">
							
							<rich:extendedDataTable id="lista" var="conMaster" value="#{cargMasterSoatController.listaMasterPrecio}" width="950px" rows="13"
								height="350px" selectionMode="single" reRender="true" > 								
								<rich:column id="colSocio" headerClass="dataTableHeader" width="20%" sortable="true" sortBy="#{conMaster.labelSocio}"
									sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
									<f:facet name="header">
										<h:outputText value="Socio" />
									</f:facet>
									<center>
										<h:outputText value="#{conMaster.labelSocio}" />
									</center>
								</rich:column>
								
								<rich:column id="colCanal" headerClass="dataTableHeader" width="20%" sortable="true" sortBy="#{conMaster.fechaInicio}"
									sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
									<f:facet name="header">
										<h:outputText value="Fecha Inicio Vigencia" />
									</f:facet>
									<center>
									<h:outputText value="#{conMaster.fechaInicio}">
										<f:convertDateTime pattern="yyyy-MM-dd" />
									</h:outputText>
									</center>
								</rich:column>
								
								<rich:column id="colLocalidad" headerClass="dataTableHeader" width="20%" sortable="true" sortBy="#{conMaster.numRegistros}"
									sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
									<f:facet name="header">
										<h:outputText value="Total Registros" />
									</f:facet>
									<center>
										<h:outputText value="#{conMaster.numRegistros}" />
									</center>
								</rich:column>
								
								<rich:column id="colUso" headerClass="dataTableHeader" width="15%" sortable="true" sortBy="#{conMaster.usuarioCreacion}"
									sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
									<f:facet name="header">
										<h:outputText value="Usuario Carga" />
									</f:facet>
									<center>
									
										<h:outputText value="#{conMaster.usuarioCreacion}" />
									</center>
								</rich:column>
								<rich:column id="colTipoVehiculo" headerClass="dataTableHeader" width="15%" sortable="true" sortBy="#{conMaster.estadoMaster}"
									sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
									<f:facet name="header">
										<h:outputText value="Estado" />
									</f:facet>
									<center>
										<h:outputText value="#{conMaster.estadoMaster}" />
									</center>
								</rich:column>
								<rich:column id="colMarca" headerClass="dataTableHeader" width="11%" sortable="true"
									sortIconAscending="dataTableAscIcon" sortIconDescending="dataTableDescIcon">
									<f:facet name="header">
										<h:outputText value="Acciones" />
									</f:facet>
									<center>
										
										<a4j:commandLink  value="Eliminar"    action="#{cargMasterSoatController.btnEliminarArchivoMaster}" reRender="lista,nroRegistros,Eliminar" onclick="if(!confirm('Esta seguro que desea eliminar?')){return false;}"   >
											<f:param name="idMasterDEL"  value="#{conMaster.idMaster}" />
										</a4j:commandLink>
										
									</center>
								</rich:column>
							
								<f:facet name="footer">
									<rich:datascroller id="ds" for="lista" maxPages="10"></rich:datascroller>
								</f:facet>
							</rich:extendedDataTable>
						</div>
						<div class="contadorRegistros" style="margin: auto; text-align: center; font-weight: bold; padding: 12px 10px 0px;">
									<h:outputText id="nroRegistros" value="N° de Registros encontrados: #{cargMasterSoatController.numeroCargaMaster}" />
								</div>
								
						<br /> <span class="separador"> 
								<a4j:commandButton id="cargarMaster" style="margin:0 5px;"	oncomplete="#{facesContext.maximumSeverity == null ? 'Richfaces.showModalPanel(\'panelMantenimiento\')' : ';'}" value="> Cargar Nuevo Master"
								                   reRender="panelMantenimiento, consultar, aceptar"/> 
								
						</span>
					</div>
				</h:form>
				</fieldset>
			</center>
		</rich:panel>
		
	<rich:modalPanel id="panelMantenimiento" autosized="true">
	<f:facet name="controls">
		<h:panelGroup>
			<h:graphicImage value="/imagenes/close.gif" styleClass="hidelink" id="hidelink" />
			<rich:componentControl for="panelMantenimiento" attachTo="hidelink" operation="hide" event="onclick" />
		</h:panelGroup>
	</f:facet>
	<h:form>
			<rich:panel id="consultar" height="100%">
		<f:facet name="header">
			<h:outputText value="Suscripción > SOAT > Master SOAT" />
		</f:facet>
		<table style="margin: 0 auto; width: 600px;" border="">
			<tr>
			
				<td width="15%" align="right">				
					<rich:message for="socio" style="color: red;">
						<f:facet name="errorMarker">
							<h:graphicImage url="../imagenes/error.png" />
						</f:facet>
					</rich:message> 
					<rich:spacer width="5"></rich:spacer> 
					<h:outputText value="Socio" />
				</td>
				
				<td style="text-align: left;" colspan="2">
					<h:selectOneMenu id="socio" value="#{cargMasterSoatController.socio}" style=" width : 220px;"
						required="true" requiredMessage="">
						<f:selectItems value="#{cargMasterSoatController.tipoSocioItems}" />
					</h:selectOneMenu>
				</td>
				
			</tr>

			<tr>
				<td width="20%" align="right">
					<rich:message for="fechaInicio" style="color: red;">
						<f:facet name="errorMarker">
							<h:graphicImage url="../imagenes/error.png" />
						</f:facet>
					</rich:message> 
					<rich:spacer width="5" /> 
					<h:outputText value="Fecha / Hora Inicio: " />
				</td>
				<td style="width: 30%; text-align: left;">
					<rich:calendar id="fechaInicio" enableManualInput="false" datePattern="dd/MM/yyyy"
						value="#{cargMasterSoatController.fechaInicio}" showWeeksBar="false" required="true" requiredMessage="">
					</rich:calendar>
				</td>
				
		
				<td width="15%" align="right">
					
					<rich:message for="fechaFin" style="color: red;">
						<f:facet name="errorMarker">
							<h:graphicImage url="../imagenes/error.png" />
						</f:facet>
					</rich:message> 
					<rich:spacer width="5" /> 
					<h:outputText value="Fecha/ Hora Fin: " />
				</td>
				
				<td style="width: 30%; text-align: left;">
					<rich:calendar id="fechaFin" enableManualInput="false" datePattern="dd/MM/yyyy"
						value="#{cargMasterSoatController.fechaFin}" showWeeksBar="false" required="true" requiredMessage="">
					</rich:calendar></td>
		
			</tr>
		
		
			<tr>
				<td width="15%" align="right">
					<rich:message for="uploader" style="color: red;">
						<f:facet name="errorMarker">
							<h:graphicImage url="../imagenes/error.png" />
						</f:facet>
					</rich:message> 
					<rich:spacer width="5" /> <h:outputText value="Archivo Master" />
					<h:outputText id="idMsjValidarMaster" value="#{cargMasterSoatController.msjValidarMaster}" />
				</td>

				<td style=" text-align: left;" colspan="3">
					<rich:fileUpload id="uploader" align="left" disabled="#{cargMasterSoatController.upload}"
						fileUploadListener="#{cargMasterSoatController.listener}" autoclear="false" acceptedTypes="xlsx,xls" maxFilesQuantity="1" allowFlash="false"
						addControlLabel="Seleccionar Archivo .xlsx"  stopEntryControlLabel="Detener Proceso"
						uploadControlLabel="Cargar Archivo" value="{_MB}MB from {MB}MB cargando --- {mm}:{ss}" listHeight="50px" listWidth="345px" required="true"
						requiredMessage="Ingrese" clearAllControlLabel="Limpiar" clearControlLabel="">
				        <f:facet name="label">				
				                <h:outputText value="{_KB}KB from {KB}KB uploaded --- {mm}:{ss}" />				
				        </f:facet>
					<!-- 	<a4j:support event="onclear" action="#{cargMasterSoatController.clear}" reRender="uploader" /> -->
						<a4j:support event="onclear" reRender="uploader" />
						<a4j:support event="onuploadcomplete" />
						<!-- reRender="btnIngresar,btnIngresarMes" -->
					</rich:fileUpload>
				</td>
				
				
				<td width="17%" align="left" />
			</tr>
			
		</table>
		<center>
		
			<a4j:commandButton id="aceptar" value="Cargar"   action="#{cargMasterSoatController.btnRegistrarArchivoMaster}" reRender="idMsjValidarMaster" oncomplete="validarMasterSoat();"/>
				<!-- 	
					<a4j:commandButton id="aceptar" action="#{cargMasterSoatController.btnRegistrarArchivoMaster}" onclick="this.disabled=true;" value="Cargar"
						oncomplete="#{facesContext.maximumSeverity == null ? 'Richfaces.showModalPanel(\'panel\');this.disabled=false;' : 'this.disabled=false;'}"
						reRender="lista, uploader" immediate="true" />
				 -->		
				
			<span style="margin: 0 7px;"> <a4j:commandButton onclick="Richfaces.hideModalPanel('panelMantenimiento');" value="Cancelar" immediate="true" />
			</span>
			
		</center>
	</rich:panel>
	</h:form>
</rich:modalPanel>
</body>


</html>
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cardif.satelite.suscripcion.dao.ConciCabTramaDiariaMapper">
	<resultMap id="BaseResultMap" type="com.cardif.satelite.model.satelite.ConciCabTramaDiaria">
		<!-- WARNING - @mbggenerated This element is automatically generated by MyBatis Generator, do not modify. This element was generated on Tue Jul 22 17:31:19 
			COT 2014. -->
		<id column="SEC_ARCHIVO" property="secArchivo" jdbcType="NUMERIC" />
		<result column="PRODUCTO" property="producto" jdbcType="NVARCHAR" />
		<result column="FEC_CARGA" property="fecCarga" jdbcType="TIMESTAMP" />
		<result column="NOMBRE_ARCHIVO" property="nomArchivo" jdbcType="NVARCHAR" />
		<result column="NRO_REGISTROS" property="numRegistros" jdbcType="NUMERIC" />
		<result column="TIPO_CARGA" property="tipoCargo" jdbcType="NVARCHAR"/>		
		<result column="FEC_CREACION" property="fecCreacion" jdbcType="TIMESTAMP" />
		<result column="USU_CREACION" property="usuCreacion" jdbcType="NVARCHAR" />
		<result column="RUTA_ARCHIVO" property="rutaArchivo" jdbcType="NVARCHAR" />
		<result column="ESTADO_CONSOLIDADO" property="estadoConsolidado" jdbcType="NVARCHAR" />
		<result column="CORRELATIVO" property="correlativo" jdbcType="NUMERIC" />		
		<result column="ESTADO" property="estado" jdbcType="NVARCHAR" />
		<result column="FLAG_TRAMA" property="flagTrama" jdbcType="NVARCHAR"/>
		
	</resultMap>
	
	<resultMap  id="Observaciones" type="com.cardif.satelite.suscripcion.bean.FormatoObservaciones">
	
		<result column="FLAG_TRAMA" property="tipoTrama" jdbcType="NVARCHAR"/>
		<result column="NOMBRE_ARCHIVO" property="nombreArchivo" jdbcType="NVARCHAR"/>
		<result column="FEC_CARGA" property="fechaCargaArchivo" jdbcType="NVARCHAR"/>
		<result column="SOCIO" property="socio" jdbcType="NVARCHAR"/>
		<result column="CANAL" property="canal" jdbcType="NVARCHAR"/>
		<result column="PLACA" property="placa" jdbcType="NVARCHAR"/>
		<result column="CLASE" property="clase" jdbcType="NVARCHAR"/>
		<result column="MARCA" property="marca" jdbcType="NVARCHAR"/>
		<result column="NRO_ASIENTOS" property="nroAsiente" jdbcType="NVARCHAR"/>
		<result column="MODELO" property="modelo" jdbcType="NVARCHAR"/>
		<result column="USO_VEHICULO" property="usoVehiculo" jdbcType="NVARCHAR"/>
		<result column="PRIMA_TECNICA" property="importePrima" jdbcType="NVARCHAR"/>
		<result column="FEC_VENTA" property="fechaVenta" jdbcType="NVARCHAR"/>
		<result column="CONTRATANTE" property="contratante" jdbcType="NVARCHAR"/>
		<result column="NUM_DOC" property="nroDocumento" jdbcType="NVARCHAR"/>
		<result column="NRO_REGISTRO" property="linea" jdbcType="NVARCHAR"/>
	
	</resultMap>	
	
	<sql id="Example_Where_Clause">
		<!-- WARNING - @mbggenerated This element is automatically generated by MyBatis Generator, do not modify. This element was generated on Tue Jul 22 17:31:19 
			COT 2014. -->
		<where>
			<foreach collection="oredCriteria" item="criteria" separator="or">
				<if test="criteria.valid">
					<trim prefix="(" suffix=")" prefixOverrides="and">
						<foreach collection="criteria.criteria" item="criterion">
							<choose>
								<when test="criterion.noValue">
									and ${criterion.condition}
								</when>
								<when test="criterion.singleValue">
									and ${criterion.condition} #{criterion.value}
								</when>
								<when test="criterion.betweenValue">
									and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
								</when>
								<when test="criterion.listValue">
									and ${criterion.condition}
									<foreach collection="criterion.value" item="listItem" open="(" close=")" separator=",">
										#{listItem}
									</foreach>
								</when>
							</choose>
						</foreach>
					</trim>
				</if>
			</foreach>
		</where>
	</sql>
	
	<sql id="Update_By_Example_Where_Clause">
		<!-- WARNING - @mbggenerated This element is automatically generated by MyBatis Generator, do not modify. This element was generated on Tue Jul 22 17:31:19 
			COT 2014. -->
		<where>
			<foreach collection="example.oredCriteria" item="criteria" separator="or">
				<if test="criteria.valid">
					<trim prefix="(" suffix=")" prefixOverrides="and">
						<foreach collection="criteria.criteria" item="criterion">
							<choose>
								<when test="criterion.noValue">
									and ${criterion.condition}
								</when>
								<when test="criterion.singleValue">
									and ${criterion.condition} #{criterion.value}
								</when>
								<when test="criterion.betweenValue">
									and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
								</when>
								<when test="criterion.listValue">
									and ${criterion.condition}
									<foreach collection="criterion.value" item="listItem" open="(" close=")" separator=",">
										#{listItem}
									</foreach>
								</when>
							</choose>
						</foreach>
					</trim>
				</if>
			</foreach>
		</where>
	</sql>
	<sql id="Base_Column_List">
		<!-- WARNING - @mbggenerated This element is automatically generated by MyBatis Generator, do not modify. This element was generated on Tue Jul 22 17:31:19 
			COT 2014. -->
		SEC_ARCHIVO, 
		PRODUCTO, 
		FEC_CARGA, 
		NOMBRE_ARCHIVO, 
		NRO_REGISTROS, 
		FEC_CREACION, 
		USU_CREACION,
		FLAG_TRAMA, 
		TIPO_CARGA, 
		RUTA_ARCHIVO,
		ESTADO_CONSOLIDADO,
		ESTADO,CORRELATIVO
	</sql>
	<select id="selectByExample" resultMap="BaseResultMap" parameterType="com.cardif.satelite.model.satelite.ConciCabTramaDiariaExample">
		<!-- WARNING - @mbggenerated This element is automatically generated by MyBatis Generator, do not modify. This element was generated on Tue Jul 22 17:31:19 
			COT 2014. -->
		select
		<if test="distinct">
			distinct
		</if>
		<include refid="Base_Column_List" />
		from TRAMA_DIARIA
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
		<if test="orderByClause != null">
			order by ${orderByClause}
		</if>
	</select>
		
   <select id="selectTramaObservaciones" resultMap="Observaciones">
    	  SELECT 
	        TD.FLAG_TRAMA,
	      	TD.CANAL,
	      	TD.SOCIO,
	      	TD.NOMBRE_ARCHIVO,
	      	TD.FEC_CARGA,
        	(CASE TDTMP.PLACA WHEN '-1' THEN '' ELSE TDTMP.PLACA END) as PLACA,
    /*    	(CASE TDTMP.CLASE WHEN '-1' THEN '' ELSE TDTMP.CLASE END) as CLASE, */
        	(CASE TDTMP.MARCA WHEN '-1' THEN '' ELSE TDTMP.MARCA END) as MARCA,
        	TDTMP.NRO_ASIENTOS ,
        	(CASE TDTMP.MODELO WHEN '-1' THEN '' ELSE TDTMP.MODELO END) as MODELO ,
        	(CASE TDTMP.USO_VEHICULO WHEN '-1' THEN '' ELSE TDTMP.USO_VEHICULO END) as USO_VEHICULO,
        	TDTMP.PRIMA_TECNICA,           
       		(CASE TDTMP.NUM_DOC WHEN '-1' THEN '' ELSE TDTMP.NUM_DOC END) as NUM_DOC,
         	TDTMP.FEC_VENTA,
         	TDTMP.SEC_ARCHIVO ,
         	TDTMP.NRO_REGISTRO ,        	
            CONCAT(TDTMP.NOM_CONTRAT,CONCAT(', ',CONCAT(TDTMP.APEL_PATE_CONTRAT,CONCAT(' ',TDTMP.APEL_MATE_CONTRAT)))) AS CONTRATANTE
    	  FROM DETALLE_TRAMA_DIARIA_TEMPORAL TDTMP 
          INNER JOIN (SELECT 
                              TRA.NOMBRE_ARCHIVO,
                              TRA.SEC_ARCHIVO,
                              TRA.FLAG_TRAMA,
                              TRA.FEC_CARGA,
                              (SELECT (SELECT NOMBRE_CANAL FROM CANAL_PRODUCTO WHERE ID = PRO.ID_CANAL) AS CANAL FROM PRODUCTO PRO WHERE PRO.ID =TRA.PRODUCTO) AS CANAL,
                              (SELECT (SELECT NOMBRE_SOCIO FROM SOCIO WHERE ID = PRO.ID_SOCIO) AS SOCIO FROM PRODUCTO PRO WHERE PRO.ID =TRA.PRODUCTO) AS SOCIO
                        FROM  TRAMA_DIARIA TRA WHERE TRA.SEC_ARCHIVO = (SELECT MAX(SEC_ARCHIVO) FROM TRAMA_DIARIA)
                    ) TD 
          ON (TD.SEC_ARCHIVO = TDTMP.SEC_ARCHIVO)
          WHERE ESTADO = 'OBSERVADO' 
          ORDER BY NRO_REGISTRO ASC
    </select> 
    
    <select id="selectTramaTemporal" resultType="java.util.Map"    parameterType="java.lang.String"  >
    		SELECT * FROM DETALLE_TRAMA_DIARIA_TEMPORAL WHERE ESTADO = 'OBSERVADO' ORDER BY NRO_REGISTRO ASC
    </select>
	
	<select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long">
		<!-- WARNING - @mbggenerated This element is automatically generated by MyBatis Generator, do not modify. This element was generated on Tue Jul 22 17:31:19 
			COT 2014. -->
		select
		<include refid="Base_Column_List" />
		from TRAMA_DIARIA
		where SEC_ARCHIVO = #{secArchivo,jdbcType=NUMERIC}
	</select>
	<delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
		<!-- WARNING - @mbggenerated This element is automatically generated by MyBatis Generator, do not modify. This element was generated on Tue Jul 22 17:31:19 
			COT 2014. -->
		delete from TRAMA_DIARIA
		where SEC_ARCHIVO = #{secArchivo,jdbcType=NUMERIC}
	</delete>
	<delete id="deleteByExample" parameterType="com.cardif.satelite.model.satelite.ConciCabTramaDiariaExample">
		<!-- WARNING - @mbggenerated This element is automatically generated by MyBatis Generator, do not modify. This element was generated on Tue Jul 22 17:31:19 
			COT 2014. -->
		delete from TRAMA_DIARIA
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
	</delete>
	<insert id="insert" parameterType="com.cardif.satelite.model.satelite.ConciCabTramaDiaria">
		<!-- WARNING - @mbggenerated This element is automatically generated by MyBatis Generator, do not modify. This element was generated on Tue Jul 22 17:31:19 
			COT 2014. -->
		insert into TRAMA_DIARIA 
		(	
			SEC_ARCHIVO,
			PRODUCTO, 
			FEC_CARGA, 
			NOMBRE_ARCHIVO,
			NRO_REGISTROS, 
			FEC_CREACION, 
			USU_CREACION, 
			TIPO_CARGA, 
			RUTA_ARCHIVO,
			ESTADO_CONSOLIDADO,
			ESTADO,
			CORRELATIVO,
			FLAG_TRAMA
			)
		VALUES(
			TRAMA_DIARIA_SEQ.NEXTVAL ,
			#{producto,jdbcType=NVARCHAR},
			#{fecCarga,jdbcType=TIMESTAMP}, 
			#{nomArchivo,jdbcType=NVARCHAR}, 
			#{numRegistros,jdbcType=NUMERIC}, 
			#{fecCreacion,jdbcType=TIMESTAMP}, 
			#{usuCreacion,jdbcType=NVARCHAR}, 
			#{tipoCargo,jdbcType=NVARCHAR}, 
			#{rutaArchivo,jdbcType=NVARCHAR},
			#{estadoConsolidado,jdbcType=NVARCHAR},
			#{estado,jdbcType=NVARCHAR},
			#{correlativo,jdbcType=NUMERIC},
			#{flagTrama,jdbcType=NVARCHAR})
	</insert>
	<insert id="insertSelective" parameterType="com.cardif.satelite.model.satelite.ConciCabTramaDiaria">
		<!-- WARNING - @mbggenerated This element is automatically generated by MyBatis Generator, do not modify. This element was generated on Tue Jul 22 17:31:19 
			COT 2014. -->
		<selectKey resultType="java.lang.Long" keyProperty="secArchivo" order="AFTER">
			SELECT SCOPE_IDENTITY()
		</selectKey>
		insert into TRAMA_DIARIA
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="producto != null">
				PRODUCTO,
			</if>
			<if test="fecCarga != null">
				FEC_CARGA,
			</if>
			<if test="nomArchivo != null">
				NOMBRE_ARCHIVO,
			</if>
			<if test="numRegistros != null">
				NRO_REGISTROS,
			</if>
			<if test="fecCreacion != null">
				FEC_CREACION,
			</if>
			<if test="usuCreacion != null">
				USU_CREACION,
			</if>
			<if test="tipoCargo !=null">
				TIPO_CARGA,
			</if>

			<if test="rutaArchivo != null">
			RUTA_ARCHIVO ,
			</if>
			<if test="estadoConsolidado != null">
			ESTADO_CONSOLIDADO ,
			</if>
			<if test="estado != null">
			ESTADO,
			</if>
			<if test="correlativo ! = null">
			CORRELATIVO,
			</if>
			<if test="flagTrama != null">
						FLAG_TRAMA,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="producto != null">
				#{producto,jdbcType=NVARCHAR},
			</if>
			<if test="fecCarga != null">
				#{fecCarga,jdbcType=TIMESTAMP},
			</if>
			<if test="nomArchivo != null">
				#{nomArchivo,jdbcType=NVARCHAR},
			</if>
			<if test="numRegistros != null">
				#{numRegistros,jdbcType=NUMERIC},
			</if>
			<if test="fecCreacion != null">
				#{fecCreacion,jdbcType=TIMESTAMP},
			</if>
			<if test="usuCreacion != null">
				#{usuCreacion,jdbcType=NVARCHAR},
			</if>
			<if test="tipoCargo !=null">			
				#{tipoCargo,jdbcType=NVARCHAR},
			</if>			
			
			<if test="rutaArchivo != null">
				#{rutaArchivo,jdbcType=NVARCHAR},
			</if>	
			<if test="estadoConsolidado != null">
				#{estadoConsolidado,jdbcType=NVARCHAR},
			</if>	
			<if test="estado != null">
				#{estado,jdbcType=NUMERIC},
			</if>
			<if test="correlativo ! = null">
				#{correlativo,jdbcType=NUMERIC},
			</if>
			<if test="flagTrama != null">
				#{flagTrama,jdbcType=NVARCHAR},
			</if>
						
		</trim>
	</insert>
	<select id="countByExample" parameterType="com.cardif.satelite.model.satelite.ConciCabTramaDiariaExample" resultType="java.lang.Integer">
		<!-- WARNING - @mbggenerated This element is automatically generated by MyBatis Generator, do not modify. This element was generated on Tue Jul 22 17:31:19 
			COT 2014. -->
		select count(*) from TRAMA_DIARIA
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
	</select>
	<update id="updateByExampleSelective" parameterType="map">
		<!-- WARNING - @mbggenerated This element is automatically generated by MyBatis Generator, do not modify. This element was generated on Tue Jul 22 17:31:19 
			COT 2014. -->
		update TRAMA_DIARIA
		<set>
			<if test="record.secArchivo != null">
				SEC_ARCHIVO = #{record.secArchivo,jdbcType=NUMERIC},
			</if>
			<if test="record.producto != null">
				PRODUCTO = #{record.producto,jdbcType=NVARCHAR},
			</if>
			<if test="record.fecCarga != null">
				FEC_CARGA = #{record.fecCarga,jdbcType=TIMESTAMP},
			</if>
			<if test="record.nomArchivo != null">
				NOMBRE_ARCHIVO = #{record.nomArchivo,jdbcType=NVARCHAR},
			</if>
			<if test="record.numRegistros != null">
				NRO_REGISTROS = #{record.numRegistros,jdbcType=NUMERIC},
			</if>
			<if test="record.fecCreacion != null">
				FEC_CREACION = #{record.fecCreacion,jdbcType=TIMESTAMP},
			</if>
			<if test="record.usuCreacion != null">
				USU_CREACION = #{record.usuCreacion,jdbcType=NVARCHAR},
			</if>
			<if test="record.tipoCargo != null">
				TIPO_CARGA = #{tipoCargo,jdbcType=NVARCHAR},
			</if>
			
			<if test="rutaArchivo != null">
			RUTA_ARCHIVO = #{rutaArchivo,jdbcType=NVARCHAR},
			</if>	
			<if test="estadoConsolidado != null">
			ESTADO_CONSOLIDADO = #{estadoConsolidado,jdbcType=NVARCHAR},
			</if>	
			<if test="estado != null">
			ESTADO = #{estado,jdbcType=NUMERIC},
			</if>	
			<if test="correlativo ! = null">
			CORRELATIVO = #{correlativo,jdbcType=NUMERIC}
			</if>
			<if test="flagTrama != null">
			FLAG_TRAMA = #{flagTrama,jdbcType=NVARCHAR},
			</if>
		</set>
		<if test="_parameter != null">
			<include refid="Update_By_Example_Where_Clause" />
		</if>
	</update>
	<update id="updateByExample" parameterType="map">
		<!-- WARNING - @mbggenerated This element is automatically generated by MyBatis Generator, do not modify. This element was generated on Tue Jul 22 17:31:19 
			COT 2014. -->
		update TRAMA_DIARIA
		set SEC_ARCHIVO = #{record.secArchivo,jdbcType=NUMERIC},
		PRODUCTO = #{record.producto,jdbcType=NVARCHAR},
		FEC_CARGA =	#{record.fecCarga,jdbcType=TIMESTAMP},
		NOMBRE_ARCHIVO = #{record.nomArchivo,jdbcType=NVARCHAR},
		NRO_REGISTROS = #{record.numRegistros,jdbcType=NUMERIC},
		FEC_CREACION = #{record.fecCreacion,jdbcType=TIMESTAMP},
		USU_CREACION = #{record.usuCreacion,jdbcType=NVARCHAR},
		TIPO_CARGA = #{tipoCargo,jdbcType=NVARCHAR},
		RUTA_ARCHIVO = #{rutaArchivo,jdbcType=NVARCHAR},
		ESTADO_CONSOLIDADO = #{estadoConsolidado,jdbcType=NVARCHAR},
		ESTADO = #{estado,jdbcType=NUMERIC},
		FLAG_TRAMA = #{flagTrama,jdbcType=NVARCHAR},
		CORRELATIVO = #{correlativo,jdbcType=NUMERIC}
		<if test="_parameter != null">
			<include refid="Update_By_Example_Where_Clause" />
		</if>
	</update>
	<update id="updateByPrimaryKeySelective" parameterType="com.cardif.satelite.model.satelite.ConciCabTramaDiaria">
		<!-- WARNING - @mbggenerated This element is automatically generated by MyBatis Generator, do not modify. This element was generated on Tue Jul 22 17:31:19 
			COT 2014. -->
		update TRAMA_DIARIA
		<set>
			<if test="producto != null">
				PRODUCTO = #{producto,jdbcType=NVARCHAR},
			</if>
			<if test="fecCarga != null">
				FEC_CARGA = #{fecCarga,jdbcType=TIMESTAMP},
			</if>
			<if test="nomArchivo != null">
				NOMBRE_ARCHIVO = #{nomArchivo,jdbcType=NVARCHAR},
			</if>
			<if test="numRegistros != null">
				NRO_REGISTROS = #{numRegistros,jdbcType=NUMERIC},
			</if>
			<if test="fecCreacion != null">
				FEC_CREACION = #{fecCreacion,jdbcType=TIMESTAMP},
			</if>
			<if test="usuCreacion != null">
				USU_CREACION = #{usuCreacion,jdbcType=NVARCHAR},
			</if>
			<if test="tipoCargo!=null">
				TIPO_CARGA = #{tipoCargo,jdbcType=NVARCHAR},
			</if>
	
			<if test="rutaArchivo != null">
			RUTA_ARCHIVO = #{rutaArchivo,jdbcType=NVARCHAR},
			</if>
			<if test="estadoConsolidado != null">
			ESTADO_CONSOLIDADO = #{estadoConsolidado,jdbcType=NVARCHAR},
			</if>
			<if test="estado != null">
			ESTADO = #{estado,jdbcType=NUMERIC},
			</if>			
			<if test="correlativo ! = null">
			CORRELATIVO = #{correlativo,jdbcType=NUMERIC},
			</if>
			<if test="flagTrama ! = null">
			FLAG_TRAMA = #{flagTrama,jdbcType=NVARCHAR},
			</if>
		</set>
		where SEC_ARCHIVO = #{secArchivo,jdbcType=NUMERIC}
	</update>
	
	<update id="updateByPrimaryKey" parameterType="com.cardif.satelite.model.satelite.ConciCabTramaDiaria">
		<!-- WARNING - @mbggenerated This element is automatically generated by MyBatis Generator, do not modify. This element was generated on Tue Jul 22 17:31:19 
			COT 2014. -->
		update TRAMA_DIARIA
		set PRODUCTO = #{producto,jdbcType=NVARCHAR},
		FEC_CARGA = #{fecCarga,jdbcType=TIMESTAMP},
		NOMBRE_ARCHIVO = #{nomArchivo,jdbcType=NVARCHAR},
		NRO_REGISTROS = #{numRegistros,jdbcType=NUMERIC},
		FEC_CREACION = #{fecCreacion,jdbcType=TIMESTAMP},
		USU_CREACION =#{usuCreacion,jdbcType=NVARCHAR},
		TIPO_CARGA = #{tipoCargo,jdbcType=NVARCHAR},
		RUTA_ARCHIVO = #{rutaArchivo,jdbcType=NVARCHAR},
		ESTADO_CONSOLIDADO = #{estadoConsolidado,jdbcType=NVARCHAR},
		ESTADO = #{estado,jdbcType=NUMERIC},
		CORRELATIVO = #{correlativo,jdbcType=NUMERIC},
		FLAG_TRAMA = #{flagTrama,jdbcType=NVARCHAR}
		where SEC_ARCHIVO = #{secArchivo,jdbcType=NUMERIC}
	</update>
</mapper>